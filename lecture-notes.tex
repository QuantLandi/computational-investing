\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{color} % For coloring code
\usepackage{background}

\backgroundsetup{
scale=1,
color=black,
opacity=0.1,
angle=45,
position=current page.center,
contents={\tikz\node[opacity=0.1, scale=8]{WORKING PAPER};}
}

% Define colors for code listing
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

% Code listing style
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

\title{Computational Investing with Python}
\author{Alexandre Landi\thanks{Emails: alexandre.landi1@ibm.com,
alexandre.landi@skema.edu,
alandi3@gatech.edu,
alexandre.landi@balanced-research.com} \\
    \textit{IBM} \\
    \textit{Skema Business School} \\
    \textit{Georgia Institute of Technology} \\
    \textit{Balanced Research} }

\begin{document}

\maketitle

\begin{abstract}
This lecture series, "Computational Investing with Python," is designed to provide a comprehensive overview of essential concepts in modern investment strategies and portfolio management, all through the lens of Python programming. The course begins by introducing foundational topics such as arithmetic and logarithmic return measurements, alongside various risk and reward measures including annualized returns, volatility, and ratios like Sharpe and Sortino. It delves into the Capital Asset Pricing Model (CAPM) to lay the groundwork for understanding asset pricing and risk management.

Building upon these basics, the series progresses into Modern Portfolio Theory (MPT), exploring diverse portfolio construction techniques. From the classic Equally Weighted and Minimum Variance portfolios to more sophisticated approaches like Mean-Variance, Black-Litterman, and Multi-Factor Models, the lectures provide both theoretical knowledge and practical Python coding examples. Special attention is given to advanced strategies like Risk-Parity and Beta-Neutral portfolios, including a unique take on optimizing the covariance matrix.

The final section focuses on back-testing methodologies, crucial for evaluating the performance of investment strategies. It covers techniques like Rolling and Expanding Windows, providing insights into their application in real-world scenarios. The series concludes with practical applications, tying together theory and computation, to equip students with the skills necessary to implement and assess their investment strategies in the dynamic world of finance.

Overall, this lecture series is tailored for those looking to blend financial theory with practical Python-based applications, offering a deep dive into computational investing strategies for both academic and professional advancement.
\end{abstract}

\section{Measuring Performance}

Imagine you are a portfolio manager entrusted with managing \$10 millions. Your primary goal is to grow this amount through strategic investments, but how will you measure your performance? This is where the concept of returns comes into play, and understanding different methods of calculating returns is crucial for your success as a portfolio manager.

\subsection{Introducing Arithmetic Returns}

Arithmetic returns, also known as simple returns, are the most straightforward way to measure the performance of your investments. Let's say you invest the entire \$10 millions in one stock, and after a year, its value increases to \$11 millions. Your arithmetic return would be calculated as follows:

\begin{align*}
    \text{Arithmetic Return} &= \frac{\text{End Value} - \text{Beginning Value}}{\text{Beginning Value}} \\
                             &= \frac{\$11\text{M} - \$10\text{M}}{\$10\text{M}} \\
                             &= 0.1 \text{ or } 10\%
\end{align*}

This calculation seems intuitive and straightforward, right? However, arithmetic returns have limitations, especially when you are dealing with multiple time periods.

\subsection{The Problem with Arithmetic Returns}

Arithmetic returns are not time-additive. This means that if you want to calculate the total return over a multi-year period, simply adding annual returns can lead to incorrect results. This limitation becomes apparent in volatile markets where investment values fluctuate significantly. \\

For example, consider a scenario where your investment grows by 10\% in the first year but then falls by 10\% in the second year. The arithmetic return for each year would be +10\% and -10\%, respectively. You might think that your total return over these two years is 0\% (since +10\% - 10\% = 0\%). However, this is not the case because the 10\% loss in the second year is on the increased amount from the first year, not the original investment. \\

\textbf{Example:}

Assume you start with a capital of \$10 million. Your investment experiences different returns over two years:

\begin{itemize}
    \item Year 1: The investment grows by 10\%.
    \item Year 2: The investment falls by 10\%.
\end{itemize}

\textbf{Calculation Using Arithmetic Returns:}

\begin{itemize}
    \item \textbf{End of Year 1:}
      \[ \text{Capital} = \$10\text{M} \times (1 + 10\%) = \$11\text{M} \]
    \item \textbf{End of Year 2:}
      \[ \text{Capital} = \$11\text{M} \times (1 - 10\%) = \$9.9\text{M} \]
    \item \textbf{Total Arithmetic Return:}
      \[ 10\% + (-10\%) = 0\% \]
\end{itemize}

Despite the arithmetic return suggesting a total return of 0\% over the two years, the actual capital at the end of Year 2 is \$9.9 million, not the original \$10 million. This example clearly demonstrates that simply adding up annual arithmetic returns can lead to incorrect conclusions about the overall investment performance, particularly in volatile markets.

\subsection{Addressing the Issue with Logarithmic Returns}

Unlike arithmetic returns, logarithmic returns provide a more accurate representation of investment performance over multiple periods, especially in volatile markets. Let's revisit the previous example using logarithmic returns. \\

\textbf{Example Revisited with Logarithmic Returns:}

Assume the same investment scenario with a starting capital of \$10 million:

\begin{itemize}
    \item Year 1: The investment grows by 10\%.
    \item Year 2: The investment falls by 10\%.
\end{itemize}

\textbf{Calculation Using Logarithmic Returns:}

\begin{itemize}
    \item \textbf{End of Year 1:}
      \[ \text{Log Return Year 1} = \ln(1 + 10\%) = \ln(1.10) \]
    \item \textbf{End of Year 2:}
      \[ \text{Log Return Year 2} = \ln(1 - 10\%) = \ln(0.90) \]
    \item \textbf{Total Logarithmic Return:}
      \begin{align*}
      \text{Total} &= \ln(1.10) + \ln(0.90) \\
                   &\approx 0.095 + (-0.105) \\
                   &\approx -0.01 \text{ or } -1\%
      \end{align*}
\end{itemize}

This looks much better, because \$10 millions minus 1\% of \$10 millions equals \$9.9 millions, which is the actual capital that we expected to have at the end of year 2. Eureka! \\

This approach accurately reflects the compounded effect of returns over time. Unlike the arithmetic method, logarithmic returns take into account the sequence of returns and the impact of gains and losses on the evolving investment value. As a result, the total logarithmic return provides a more realistic picture of the investment performance across multiple periods, especially in markets with significant fluctuations.          
\\

\subsection{Another Example: Arithmetic vs. Logarithmic Returns}

Now let's say that our \$10 million portfolio changes over three years as follows:

\begin{itemize}
    \item Year 1: \$12 million
    \item Year 2: \$9 million
    \item Year 3: \$13.5 million
\end{itemize}

\subsubsection{Arithmetic Returns Calculation}

\begin{align*}
    \text{Year 1 Arithmetic Return} &= \frac{\$12M - \$10M}{\$10M} = 0.20 \, \text{(or 20\%)} \\
    \text{Year 2 Arithmetic Return} &= \frac{\$9M - \$12M}{\$12M} = -0.25 \, \text{(or -25\%)} \\
    \text{Year 3 Arithmetic Return} &= \frac{\$13.5M - \$9M}{\$9M} = 0.50 \\
    \text{Total Arithmetic Return} &= 20\% - 25\% + 50\% = 45\%
\end{align*}

Again, this doesn't look right. Our \$10 million portfolio did not grow by 45\%, but rather 35\%. So now let's try with logarithmic returns:

\subsubsection{Logarithmic Returns Calculation}

\begin{align*}
    \text{Year 1 Logarithmic Return} &= \ln\left(\frac{\$12M}{\$10M}\right) = \ln(1.20) \\
    \text{Year 2 Logarithmic Return} &= \ln\left(\frac{\$9M}{\$12M}\right) = \ln(0.75) \\
    \text{Year 3 Logarithmic Return} &= \ln\left(\frac{\$13.5M}{\$9M}\right) = \ln(1.5) \\
\end{align*}

\begin{align*}
    \text{Total Logarithmic Return} &= \ln(1.20) + \ln(0.75) + \ln(1.5) \\
                                    &\approx 0.18 + (-0.29) + 0.41 \\
                                    &\approx 0.30 \text{ or } 30\%
\end{align*}

That looks a little bit closer, but not quite right yet. We had \$10 millions at year 0 and we have \$13.5 millions at year 3, hence we would expect a cumulative return of 35\%, not 30\%. 

\subsubsection{Calculating Final Investment Value Using Logarithmic Returns}

Logarithmic returns provide a nuanced way to measure investment performance over multiple periods. To convert the total logarithmic return to an actual final investment value, we need to follow specific steps. Let's see how this is done: \\

\textbf{Steps to Calculate Final Value:}

Assuming an initial investment value and a calculated total logarithmic return over multiple periods, the final investment value is computed as follows:

\begin{enumerate}
    \item \textbf{Exponentiate the Total Logarithmic Return:} This step reverses the logarithmic operation, translating the compounded growth rate back to a multiplicative factor.
    \begin{align*}
        \text{Growth Factor} &= e^{\text{Total Logarithmic Return}}
    \end{align*}
    
    \item \textbf{Multiply by Initial Investment Value:} The growth factor is then applied to the initial value to get the final investment value.
    \begin{align*}
        \text{Final Investment Value} &= \text{Initial Value} \times \text{Growth Factor}
    \end{align*}
\end{enumerate}

\textbf{Why Exponentiate the Total Logarithmic Return?}

Logarithmic returns convert multiplicative growth rates into additive values, making them ideal for analyzing compounded growth over time. To revert these additive values back to a growth factor, we use exponentiation. Here's the algebraic rationale:

\begin{enumerate}
    \item \textbf{Inverting the Logarithm:}
          Logarithmic returns represent the natural logarithm (ln) of growth ratios. The inverse of taking a logarithm is exponentiation (raising e to the power of the logarithmic return).
          \begin{align*}
              \text{If } \text{Log Return} &= \ln(\text{Growth Ratio}) \\
              \text{Then } \text{Growth Ratio} &= e^{\text{Log Return}}
          \end{align*}

    \item \textbf{Applying to Total Logarithmic Return:}
          The total logarithmic return over multiple periods represents the cumulative compounded growth in logarithmic terms. Exponentiating this value converts it back to a real growth factor.
          \begin{align*}
              \text{Growth Factor} &= e^{\text{Total Logarithmic Return}}
          \end{align*}
\end{enumerate}

\textbf{Calculating the Final Investment Value:}

Given the total logarithmic return and the initial investment value, the final value is calculated as follows:

\begin{enumerate}
    \item \textbf{Exponentiate the Total Logarithmic Return:}
          \begin{align*}
              \text{Growth Factor} &= e^{\text{Total Logarithmic Return}}
          \end{align*}

    \item \textbf{Multiply by Initial Investment Value:}
          \begin{align*}
              \text{Final Investment Value} &= \text{Initial Investment Value} \times \text{Growth Factor}
          \end{align*}
\end{enumerate}

\textbf{Example:}

Let's apply these steps to our previous example:

\begin{itemize}
    \item Initial Investment Value: \$10 million
    \item Total Logarithmic Return over 3 Years: Approximately 0.30
\end{itemize}

\begin{enumerate}
    \item Calculate the growth factor:
    \begin{align*}
        \text{Growth Factor} &= e^{0.30}
    \end{align*}
    
    \item Calculate the final investment value:
    \begin{align*}
        \text{Final Investment Value} &= \text{Initial Value} \times \text{Growth Factor} \\
                                      &= \$10M \times e^{0.30} \\
                                      &\approx \$10M \times 1.35 \\
                                      &\approx \$13.5M
    \end{align*}
\end{enumerate}


Yay! This calculation provides the actual value of the investment at the end of the period, reflecting the compounded growth captured by the logarithmic returns. \\

If you just wanted to know the percentage cumulative return, we would simply subtract 1 from the growth factor.

\begin{align*}
    \text{Cumulative Return} &= \text{Growth Factor} - 1 \\
                             &= e^{0.30} - 1 \\
                             &\approx 1.35 - 1 \\
                             &\approx 0.35 \text{ or } 35\%
\end{align*}

Eureka!

\subsubsection{Comparison and Conclusion}

While the arithmetic method suggests a total return of 45\% over three years, the logarithmic method, which accurately accounts for compounding, indicates a different (and more accurate) cumulative return of 35\%. This example highlights the importance of using logarithmic returns for a more accurate assessment of portfolio performance over multiple periods.



\subsection{Python Exercise: Calculating and Visualizing Returns}

You are given a dataset representing the annual closing values of an investment portfolio over a five-year period with more volatile values. Calculate both the arithmetic and logarithmic returns for each year, the total returns over the entire period, and visualize the cumulative returns to see the difference visually. \\

Annual closing values of the portfolio (in millions USD):

\begin{itemize}
    \item Year 0: \$10.0
    \item Year 1: \$12.5
    \item Year 2: \$8.0
    \item Year 3: \$13.5
    \item Year 4: \$7.5
    \item Year 5: \$15.0
\end{itemize}

\subsubsection{Calculate and Plot Annual Arithmetic and Logarithmic Returns}

\begin{lstlisting}[language=Python]
import numpy as np
import matplotlib.pyplot as plt

# Updated portfolio values
values = np.array([10.0, 12.5, 8.0, 13.5, 7.5, 15.0])

# Calculating arithmetic and logarithmic returns
arithmetic_returns = (values[1:] - values[:-1]) / values[:-1]
log_returns = np.log(values[1:] / values[:-1])

# Plotting the returns
plt.figure(figsize=(10, 6))
plt.plot(arithmetic_returns, label='Arithmetic Returns', marker='o')
plt.plot(log_returns, label='Logarithmic Returns', marker='x')
plt.title('Annual Arithmetic vs. Logarithmic Returns')
plt.xlabel('Year')
plt.ylabel('Returns')
plt.legend()
plt.grid(True)
plt.show()
\end{lstlisting}

\subsubsection{Calculate and Plot Cumulative Returns}

\begin{lstlisting}[language=Python]
# Calculating cumulative returns
cumulative_arithmetic_return = np.cumsum(arithmetic_returns)
cumulative_logarithmic_return = np.exp(np.cumsum(log_returns)) - 1

# Plotting cumulative returns
plt.figure(figsize=(10, 6))
plt.plot(cumulative_arithmetic_return, label='Cumulative Arithmetic Returns', marker='o')
plt.plot(cumulative_logarithmic_return, label='Cumulative Logarithmic Returns', marker='x')
plt.title('Cumulative Arithmetic vs. Logarithmic Returns')
plt.xlabel('Year')
plt.ylabel('Cumulative Returns')
plt.legend()
plt.grid(True)
plt.show()
\end{lstlisting}

\subsubsection{Compare and Discuss}

After plotting the returns, compare the graphs of arithmetic and logarithmic returns, as well as their cumulative returns. Discuss the visual differences and the implications of these differences for investment performance measurement.

\subsubsection{Expected Outcomes}

By now, you should be able to:
\begin{itemize}
    \item Write a Python script to calculate, compare, and plot arithmetic and logarithmic returns.
    \item Visualize the difference in cumulative returns using matplotlib.
    \item Articulate the insights gained from the visual comparison of the two methods.
\end{itemize}

\subsection{Python Exercise: S\&P 500 Futures Data Analysis}

In this exercise, you will apply the concepts of calculating and visualizing returns to real-world financial data. You will download daily data of S\&P 500 front month futures from Yahoo Finance and perform a similar analysis as above.

\subsubsection{Downloading the Data}

To get started, you need to download the daily price data for S\&P 500 futures. This can be done using Python's \texttt{pandas} and \texttt{yfinance} libraries. Here is a step-by-step guide to download the data and put it into a pandas dataframe:

\begin{lstlisting}[language=Python]
import yfinance as yf
import pandas as pd

# Downloading S&P 500 futures data
ticker = "ES=F"  # S&P 500 front-month futures ticker symbol
data = yf.download(ticker)

# Creating a pandas dataframe
sp500_data = pd.DataFrame(data)
print(sp500_data.head())  # Displaying the first few rows
\end{lstlisting}

\subsubsection{Your Task}

Using this data, calculate and plot the annual arithmetic and logarithmic returns of the S\&P 500 futures. Then, analyze the cumulative returns over the entire period. You should:

\begin{enumerate}
    \item \textbf{Calculate and Plot Cumulative Returns:} Similar to the previous exercise, calculate the cumulative arithmetic and logarithmic returns for the S\&P 500 futures data.
    \item \textbf{Compare and Discuss:} Analyze the plots and discuss the visual differences. What insights can you gain about the performance of the S\&P 500 futures over this period?
\end{enumerate}

\subsubsection{Expected Learning Outcome}

This exercise will help you to:
\begin{itemize}
    \item Apply the concepts of returns calculation to real-world financial data.
    \item Develop skills in data handling and analysis using Python.
    \item Gain insights into the practical implications of different return measurement methods in financial markets.
\end{itemize}

\textit{Note:} This exercise is exploratory and intended to deepen your understanding of financial data analysis. No solution is provided; you are encouraged to explore and interpret the data independently.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item How are arithmetic returns calculated for an investment?
    \begin{enumerate}
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}} - 1\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item \(\ln(\frac{P_{\text{final}}}{P_{\text{initial}}})\), where \(P_{\text{initial}}\) and \(P_{\text{final}}\) are the initial and final prices of the asset, respectively.
        \item \(\frac{P_{\text{final}} - P_{\text{initial}}}{P_{\text{initial}}}\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item The sum of the natural logarithm of the final price minus the natural logarithm of the initial price.
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}}\), where \(P_{\text{final}}\) and \(P_{\text{initial}}\) are the final and initial values of the investment.
    \end{enumerate}

    \item Which of the following statements are true about the properties of logarithms?
    \begin{enumerate}
        \item \(\ln(a \times b) = \ln(a) + \ln(b)\) for any positive numbers \(a\) and \(b\).
        \item \(\ln\left(\frac{a}{b}\right) = \ln(a) - \ln(b)\) for any positive numbers \(a\) and \(b\).
        \item \(\ln(a^b) = b \times \ln(a)\) for any positive number \(a\) and any number \(b\).
        \item \(\ln(a + b) = \ln(a) + \ln(b)\) for any positive numbers \(a\) and \(b\).
        \item The natural logarithm of a negative number is undefined.
    \end{enumerate}

    \item How are logarithmic returns calculated for an investment?
    \begin{enumerate}
        \item \(\frac{P_{\text{final}} - P_{\text{initial}}}{P_{\text{initial}}}\), where \(P_{\text{initial}}\) and \(P_{\text{final}}\) are the initial and final prices of the asset, respectively.
        \item \(\ln(\frac{P_{\text{final}}}{P_{\text{initial}}})\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item \(\ln(P_{\text{final}}) - \ln(P_{\text{initial}})\), where \(P_{\text{initial}}\) and \(P_{\text{final}}\) are the initial and final prices of the asset, respectively.
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}} - 1\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}}\), where \(P_{\text{final}}\) and \(P_{\text{initial}}\) are the final and initial values of the investment.
    \end{enumerate}

    \item Based on the advantages and disadvantages of logarithmic and arithmetic returns, which of the following statements are true?
    \begin{enumerate}
        \item Arithmetic returns are more accurate than logarithmic returns for multi-period analysis due to their simplicity in calculation.
        \item Logarithmic returns inherently account for the compounding effects and are more suited for analyzing multiple-period returns.
        \item Arithmetic returns do not consider the compounding effect, which can lead to misleading results in volatile markets over multiple periods.
        \item Logarithmic returns cannot be used for risk assessment and volatility analysis in financial markets.
        \item The total logarithmic return for multiple periods is the product of the logarithmic returns of each period.
    \end{enumerate}

    \item Given a dataframe of daily prices, which Python code snippet is most appropriate to compute the total logarithmic return over a multi-year period?
    \begin{enumerate}
        \item \texttt{total\_log\_return = df['Price'].pct\_change().sum()}
        \item \texttt{total\_log\_return = np.log(df['Price'] / df['Price'].shift(1)).sum()}
        \item \texttt{total\_log\_return = (df['Price'].iloc[-1] / df['Price'].iloc[0]) - 1}
        \item \texttt{total\_log\_return = np.log(df['Price']).diff().sum()}
        \item \texttt{total\_log\_return = (df['Price'].pct\_change() + 1).prod() - 1}
    \end{enumerate}

    \item Consider an investment with the following annual closing values over three years, starting with a \$10 million portfolio:
    \begin{itemize}
        \item Year 1: \$11 million
        \item Year 2: \$8 million
        \item Year 3: \$12 million
    \end{itemize}
    Using logarithmic returns, calculate the total logarithmic return and the final investment value. Which of the following statements are correct?
    \begin{enumerate}
        \item The total logarithmic return is approximately 0.20, and the final investment value is about \$12 million.
        \item The total logarithmic return is approximately 0.18, and the final investment value is about \$11.8 million.
        \item The growth factor calculated from the total logarithmic return is about 1.22.
        \item The final investment value is approximately \$12.2 million.
        \item The cumulative return over the three years is approximately 20\%.
    \end{enumerate}

    \item Given the following annual closing values of an investment portfolio (in millions USD):
    \begin{itemize}
        \item Year 0: \$10.0
        \item Year 1: \$13.0
        \item Year 2: \$7.0
        \item Year 3: \$14.0
        \item Year 4: \$8.0
        \item Year 5: \$16.0
    \end{itemize}
    Which of the following lines of Python code will correctly calculate the cumulative arithmetic and logarithmic returns?
    
    \begin{enumerate}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_arithmetic\_return = np.sum((values[1:] - values[:-1]) / values[:-1])}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_logarithmic\_return = np.exp(np.sum(np.log(values[1:] / values[:-1])))}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_arithmetic\_return = np.prod((values[1:] / values[:-1]) - 1)}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_logarithmic\_return = np.exp(np.sum(np.log(values[1:] / values[:-1]))) - 1}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_arithmetic\_return = np.cumsum((values[1:] - values[:-1]) / values[:-1])[-1]}
    \end{enumerate}

\end{enumerate}

\section{Harmonizing Performance Measurement}

\subsection{The Problem: Comparing Returns Over Different Time Periods}

Consider three different investments, each with returns reported over different time frames. How can you know which one performed best or worst?

\subsubsection*{Investment Scenarios}

\begin{itemize}
    \item \textbf{Investment A:} Reported a return of 6\% in one month.
    \item \textbf{Investment B:} Reported a return of 15\% over three months.
    \item \textbf{Investment C:} Reported a return of 25\% over a year.
    \item \textbf{Investment D:} Reported a return of 0.2\% in one day.
    \item \textbf{Investment E:} Reported a return of 1.5\% over one week.
\end{itemize}



\subsection{The Solution: Annualizing Logarithmic Returns}

To fairly compare the performance of these investments over different time frames, we utilize the concept of annualizing logarithmic returns. This method allows us to standardize returns to a common time frame (one year), taking into account the effect of compounding.

\subsubsection*{Understanding Logarithmic Returns}

Logarithmic returns, represented as $\ln(1 + r)$ where $r$ is the return, are particularly useful when dealing with compound interest and fluctuating investment values. They allow for additive properties over time, making them ideal for aggregation over different periods.

\subsubsection*{Annualizing the Returns}

The annualization of logarithmic returns involves scaling the log returns to a yearly basis. This is done by multiplying the log return by the number of respective periods in a year.

\subsubsection*{Calculating Annualized Returns for Each Investment}

\textbf{Investment A (Monthly):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.06) \\
    \text{Annualized Return} &= \ln(1 + 0.06) \times 12 \quad \text{(12 months in a year)}
\end{align*}

\textbf{Investment B (Quarterly):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.15) \\
    \text{Annualized Return} &= \ln(1 + 0.15) \times 4 \quad \text{(4 quarters in a year)}
\end{align*}

\textbf{Investment C (Annually):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.25) \quad \text{(Already annual)}
\end{align*}

\textbf{Investment D (Daily):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.002) \\
    \text{Annualized Return} &= \ln(1 + 0.002) \times 252 \quad \text{(252 trading days in a year)}
\end{align*}

\textbf{Investment E (Weekly):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.015) \\
    \text{Annualized Return} &= \ln(1 + 0.015) \times 52 \quad \text{(52 weeks in a year)}
\end{align*}

\subsubsection*{Interpreting the Results}

The annualized logarithmic returns provide a standardized way to compare the investments. A higher annualized return indicates better performance over the year, irrespective of the original investment period. This method accounts for the compound nature of returns, offering a more accurate measure of performance, especially for volatile or inconsistent returns over time.

\subsection{Conclusion}

The annualization of logarithmic returns is a powerful tool in performance measurement, harmonizing the comparison of returns across different investment time frames. It ensures a level playing field, allowing investors and analysts to make informed decisions based on standardized and comparable data.

\subsection*{Python Exercise: Downloading S\&P500 Futures Prices and Calculating Annualized Mean Logarithmic Return}

\textbf{Objective:} Download the front month S\&P500 futures prices, compute the logarithmic returns, and then annualize the mean return. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Steps:}

\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure you have the necessary libraries installed. You can install them using pip:
    \begin{verbatim}
    pip install pandas numpy yfinance
    \end{verbatim}

    \begin{lstlisting}[language=Python]
    # Import libraries
    import pandas as pd
    import numpy as np
    import yfinance as yf

    # Use the `yfinance` library to download the front month S&P500 futures price data.
    sp500_futures = yf.download('ES=F')

    # Calculate the daily logarithmic returns of the futures prices.
    sp500_futures['Log_Returns'] = np.log(sp500_futures['Adj Close'] / sp500_futures['Adj Close'].shift(1))

    # Annualize the mean of the logarithmic returns.
    annualized_return = sp500_futures['Log_Return'].mean() * 252
    print("annualized_return:", annualized_return)
    \end{lstlisting}
\end{enumerate}


\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item Given the following investment scenarios with different time frames, calculate the annualized logarithmic returns and identify which investments have the highest and lowest annualized returns.
    \begin{itemize}
        \item Investment F: Reported a return of 7\% in one month.
        \item Investment G: Reported a return of 10\% over two months.
        \item Investment H: Reported a return of 18\% over six months.
        \item Investment I: Reported a return of 0.1\% in one day.
        \item Investment J: Reported a return of 2\% over one week.
    \end{itemize}
    Which of the following statements are correct?

    \begin{enumerate}
        \item Investment F has the highest annualized return.
        \item Investment I has the lowest annualized return.
        \item Investment G has a higher annualized return than Investment H.
        \item Investment J has a higher annualized return than Investment F.
        \item Investment H has the highest annualized return.
    \end{enumerate}

    \item When calculating the annualized mean return using logarithmic returns for a dataset of daily returns, which of the following statements are correct?

    \begin{enumerate}
        \item The annualized mean return can be calculated by summing the logarithmic returns and multiplying by 252.
        \item To calculate the logarithmic return for each day, you divide the price at the end of the day by the price at the beginning of the day.
        \item The annualized mean return provides an average rate of return per month.
        \item Logarithmic returns are preferred as they can be easily summed over time.
        \item The annualized mean return is calculated using simple returns and does not need any scaling factor.
    \end{enumerate}

    \item Which of the following Python code snippets correctly calculates and annualizes the logarithmic returns of an investment based on daily price data?
    \begin{enumerate}
        \item \texttt{annualized\_return = np.log(df['Close'] / df['Close'].shift(1)).mean() * 252}
        \item \texttt{annualized\_return = df['Close'].pct\_change().mean() * 252}
        \item \texttt{annualized\_return = np.sum(np.log(df['Close'] / df['Close'].shift(1))) / len(df) * 252}
        \item \texttt{annualized\_return = np.log(df['Adj Close'] / df['Adj Close'].shift(1)).mean() * 252}
        \item \texttt{annualized\_return = (df['Close'].iloc[-1] / df['Close'].iloc[0] - 1) * 252}
    \end{enumerate}
\end{enumerate}

\end{document}
