\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{color} % For coloring code
\usepackage{background}
\usepackage{float}
\bibliographystyle{apalike}


\backgroundsetup{
scale=1,
color=black,
opacity=0.1,
angle=45,
position=current page.center,
contents={\tikz\node[opacity=0.1, scale=8]{WORKING PAPER};}
}

% Define colors for code listing
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

% Code listing style
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

\title{Computational Investing with Python}
\author{Alexandre Landi\thanks{Emails: alexandre.landi1@ibm.com,
alexandre.landi@skema.edu,
alandi3@gatech.edu,
alexandre.landi@balanced-research.com} \\
    \textit{IBM} \\
    \textit{Skema Business School} \\
    \textit{Georgia Institute of Technology} \\
    \textit{Balanced Research} }

\begin{document}

\maketitle

\begin{abstract}
This lecture series, "Computational Investing with Python," is designed to provide a comprehensive overview of essential concepts in modern investment strategies and portfolio management, all through the lens of Python programming. The course begins by introducing foundational topics such as arithmetic and logarithmic return measurements, alongside various risk and reward measures including annualized returns, volatility, and ratios like Sharpe and Sortino. It delves into the Capital Asset Pricing Model (CAPM) to lay the groundwork for understanding asset pricing and risk management.

Building upon these basics, the series progresses into Modern Portfolio Theory (MPT), exploring diverse portfolio construction techniques. From the classic Equally Weighted and Minimum Variance portfolios to more sophisticated approaches like Mean-Variance, Black-Litterman, and Multi-Factor Models, the lectures provide both theoretical knowledge and practical Python coding examples. Special attention is given to advanced strategies like Risk-Parity and Beta-Neutral portfolios, including a unique take on optimizing the covariance matrix.

The final section focuses on back-testing methodologies, crucial for evaluating the performance of investment strategies. It covers techniques like Rolling and Expanding Windows, providing insights into their application in real-world scenarios. The series concludes with practical applications, tying together theory and computation, to equip students with the skills necessary to implement and assess their investment strategies in the dynamic world of finance.

Overall, this lecture series is tailored for those looking to blend financial theory with practical Python-based applications, offering a deep dive into computational investing strategies for both academic and professional advancement.
\end{abstract}

\tableofcontents
\clearpage

\section{Measuring Returns}

Imagine you are a portfolio manager entrusted with managing \$10 millions. Your primary goal is to grow this amount through strategic investments, but how will you measure your performance? This is where the concept of returns comes into play, and understanding different methods of calculating returns is crucial for your success as a portfolio manager \cite{bodie2018investments}.

\subsection{Introducing Arithmetic Returns}

Arithmetic returns, also known as simple returns, are the most straightforward way to measure the performance of your investments. Let's say you invest the entire \$10 millions in one stock, and after a year, its value increases to \$11 millions. Your arithmetic return would be calculated as follows:

\begin{align*}
    \text{Arithmetic Return} &= \frac{\text{End Value} - \text{Beginning Value}}{\text{Beginning Value}} \\
                             &= \frac{\$11\text{M} - \$10\text{M}}{\$10\text{M}} \\
                             &= 0.1 \text{ or } 10\%
\end{align*}

This calculation seems intuitive and straightforward, right? However, arithmetic returns have limitations, especially when you are dealing with multiple time periods \cite{fabozzi2010foundations}.

\subsection{The Problem with Arithmetic Returns}

Arithmetic returns are not time-additive. This means that if you want to calculate the total return over a multi-year period, simply adding annual returns can lead to incorrect results. This limitation becomes apparent in volatile markets where investment values fluctuate significantly \cite{lo1988stock}. \\

For example, consider a scenario where your investment grows by 10\% in the first year but then falls by 10\% in the second year. The arithmetic return for each year would be +10\% and -10\%, respectively. You might think that your total return over these two years is 0\% (since +10\% - 10\% = 0\%). However, this is not the case because the 10\% loss in the second year is on the increased amount from the first year, not the original investment. \\

\textbf{Example:}

Assume you start with a capital of \$10 million. Your investment experiences different returns over two years:

\begin{itemize}
    \item Year 1: The investment grows by 10\%.
    \item Year 2: The investment falls by 10\%.
\end{itemize}

\textbf{Calculation Using Arithmetic Returns:}

\begin{itemize}
    \item \textbf{End of Year 1:}
      \[ \text{Capital} = \$10\text{M} \times (1 + 10\%) = \$11\text{M} \]
    \item \textbf{End of Year 2:}
      \[ \text{Capital} = \$11\text{M} \times (1 - 10\%) = \$9.9\text{M} \]
    \item \textbf{Total Arithmetic Return:}
      \[ 10\% + (-10\%) = 0\% \]
\end{itemize}

Despite the arithmetic return suggesting a total return of 0\% over the two years, the actual capital at the end of Year 2 is \$9.9 million, not the original \$10 million. This example clearly demonstrates that simply adding up annual arithmetic returns can lead to incorrect conclusions about the overall investment performance, particularly in volatile markets \cite{campbell1988dividend}.

\subsection{Addressing the Issue with Logarithmic Returns}

Unlike arithmetic returns, logarithmic returns provide a more accurate representation of investment performance over multiple periods, especially in volatile markets. Let's revisit the previous example using logarithmic returns. \\

\textbf{Example Revisited with Logarithmic Returns:}

Assume the same investment scenario with a starting capital of \$10 million:

\begin{itemize}
    \item Year 1: The investment grows by 10\%.
    \item Year 2: The investment falls by 10\%.
\end{itemize}

\textbf{Calculation Using Logarithmic Returns:}

\begin{itemize}
    \item \textbf{End of Year 1:}
      \[ \text{Log Return Year 1} = \ln(1 + 10\%) = \ln(1.10) \]
    \item \textbf{End of Year 2:}
      \[ \text{Log Return Year 2} = \ln(1 - 10\%) = \ln(0.90) \]
    \item \textbf{Total Logarithmic Return:}
      \begin{align*}
      \text{Total} &= \ln(1.10) + \ln(0.90) \\
                   &\approx 0.095 + (-0.105) \\
                   &\approx -0.01 \text{ or } -1\%
      \end{align*}
\end{itemize}

This looks much better, because \$10 millions minus 1\% of \$10 millions equals \$9.9 millions, which is the actual capital that we expected to have at the end of year 2. Eureka! \\

This approach accurately reflects the compounded effect of returns over time. Unlike the arithmetic method, logarithmic returns take into account the sequence of returns and the impact of gains and losses on the evolving investment value. As a result, the total logarithmic return provides a more realistic picture of the investment performance across multiple periods, especially in markets with significant fluctuations.          
\\

\subsubsection{Another Example: Arithmetic vs. Logarithmic Returns}

Now let's say that our \$10 million portfolio changes over three years as follows:

\begin{itemize}
    \item Year 1: \$12 million
    \item Year 2: \$9 million
    \item Year 3: \$13.5 million
\end{itemize}

\subsubsection{Arithmetic Returns Calculation}

\begin{align*}
    \text{Year 1 Arithmetic Return} &= \frac{\$12M - \$10M}{\$10M} = 0.20 \, \text{(or 20\%)} \\
    \text{Year 2 Arithmetic Return} &= \frac{\$9M - \$12M}{\$12M} = -0.25 \, \text{(or -25\%)} \\
    \text{Year 3 Arithmetic Return} &= \frac{\$13.5M - \$9M}{\$9M} = 0.50 \\
    \text{Total Arithmetic Return} &= 20\% - 25\% + 50\% = 45\%
\end{align*}

Again, this doesn't look right. Our \$10 million portfolio did not grow by 45\%, but rather 35\%. So now let's try with logarithmic returns:

\subsubsection{Logarithmic Returns Calculation}

\begin{align*}
    \text{Year 1 Logarithmic Return} &= \ln\left(\frac{\$12M}{\$10M}\right) = \ln(1.20) \\
    \text{Year 2 Logarithmic Return} &= \ln\left(\frac{\$9M}{\$12M}\right) = \ln(0.75) \\
    \text{Year 3 Logarithmic Return} &= \ln\left(\frac{\$13.5M}{\$9M}\right) = \ln(1.5) \\
\end{align*}

\begin{align*}
    \text{Total Logarithmic Return} &= \ln(1.20) + \ln(0.75) + \ln(1.5) \\
                                    &\approx 0.18 + (-0.29) + 0.41 \\
                                    &\approx 0.30 \text{ or } 30\%
\end{align*}

That looks a little bit closer, but not quite right yet. We had \$10 millions at year 0 and we have \$13.5 millions at year 3, hence we would expect a cumulative return of 35\%, not 30\%. 

\subsubsection{Calculating Final Investment Value Using Logarithmic Returns}

Logarithmic returns provide a nuanced way to measure investment performance over multiple periods. To convert the total logarithmic return to an actual final investment value, we need to follow specific steps. Let's see how this is done: \\

\textbf{Steps to Calculate Final Value:}

Assuming an initial investment value and a calculated total logarithmic return over multiple periods, the final investment value is computed as follows:

\begin{enumerate}
    \item \textbf{Exponentiate the Total Logarithmic Return:} This step reverses the logarithmic operation, translating the compounded growth rate back to a multiplicative factor.
    \begin{align*}
        \text{Growth Factor} &= e^{\text{Total Logarithmic Return}}
    \end{align*}
    
    \item \textbf{Multiply by Initial Investment Value:} The growth factor is then applied to the initial value to get the final investment value.
    \begin{align*}
        \text{Final Investment Value} &= \text{Initial Value} \times \text{Growth Factor}
    \end{align*}
\end{enumerate}

\textbf{Why Exponentiate the Total Logarithmic Return?}

Logarithmic returns convert multiplicative growth rates into additive values, making them ideal for analyzing compounded growth over time. To revert these additive values back to a growth factor, we use exponentiation. Here's the algebraic rationale:

\begin{enumerate}
    \item \textbf{Inverting the Logarithm:}
          Logarithmic returns represent the natural logarithm (ln) of growth ratios. The inverse of taking a logarithm is exponentiation (raising e to the power of the logarithmic return).
          \begin{align*}
              \text{If } \text{Log Return} &= \ln(\text{Growth Ratio}) \\
              \text{Then } \text{Growth Ratio} &= e^{\text{Log Return}}
          \end{align*}

    \item \textbf{Applying to Total Logarithmic Return:}
          The total logarithmic return over multiple periods represents the cumulative compounded growth in logarithmic terms. Exponentiating this value converts it back to a real growth factor.
          \begin{align*}
              \text{Growth Factor} &= e^{\text{Total Logarithmic Return}}
          \end{align*}
\end{enumerate}

\textbf{Calculating the Final Investment Value:}

Given the total logarithmic return and the initial investment value, the final value is calculated as follows:

\begin{enumerate}
    \item \textbf{Exponentiate the Total Logarithmic Return:}
          \begin{align*}
              \text{Growth Factor} &= e^{\text{Total Logarithmic Return}}
          \end{align*}

    \item \textbf{Multiply by Initial Investment Value:}
          \begin{align*}
              \text{Final Investment Value} &= \text{Initial Investment Value} \times \text{Growth Factor}
          \end{align*}
\end{enumerate}

\textbf{Example:}

Let's apply these steps to our previous example:

\begin{itemize}
    \item Initial Investment Value: \$10 million
    \item Total Logarithmic Return over 3 Years: Approximately 0.30
\end{itemize}

\begin{enumerate}
    \item Calculate the growth factor:
    \begin{align*}
        \text{Growth Factor} &= e^{0.30}
    \end{align*}
    
    \item Calculate the final investment value:
    \begin{align*}
        \text{Final Investment Value} &= \text{Initial Value} \times \text{Growth Factor} \\
                                      &= \$10M \times e^{0.30} \\
                                      &\approx \$10M \times 1.35 \\
                                      &\approx \$13.5M
    \end{align*}
\end{enumerate}


Yay! This calculation provides the actual value of the investment at the end of the period, reflecting the compounded growth captured by the logarithmic returns. \\

If you just wanted to know the percentage cumulative return, we would simply subtract 1 from the growth factor.

\begin{align*}
    \text{Cumulative Return} &= \text{Growth Factor} - 1 \\
                             &= e^{0.30} - 1 \\
                             &\approx 1.35 - 1 \\
                             &\approx 0.35 \text{ or } 35\%
\end{align*}

Eureka!

\subsubsection{Comparison and Conclusion}

While the arithmetic method suggests a total return of 45\% over three years, the logarithmic method, which accurately accounts for compounding, indicates a different (and more accurate) cumulative return of 35\%. This example highlights the importance of using logarithmic returns for a more accurate assessment of portfolio performance over multiple periods.

\subsection{Python Exercise: Calculating and Visualizing Returns}

You are given a dataset representing the annual closing values of an investment portfolio over a five-year period with more volatile values. Calculate both the arithmetic and logarithmic returns for each year, the total returns over the entire period, and visualize the cumulative returns to see the difference visually. \\

Annual closing values of the portfolio (in millions USD):

\begin{itemize}
    \item Year 0: \$10.0
    \item Year 1: \$12.5
    \item Year 2: \$8.0
    \item Year 3: \$13.5
    \item Year 4: \$7.5
    \item Year 5: \$15.0
\end{itemize}

\subsubsection{Calculate and Plot Annual Arithmetic and Logarithmic Returns}

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, matplotlib
\end{itemize}

\begin{lstlisting}[language=Python]
import numpy as np
import matplotlib.pyplot as plt

# Updated portfolio values
values = np.array([10.0, 12.5, 8.0, 13.5, 7.5, 15.0])

# Calculating arithmetic and logarithmic returns
arithmetic_returns = (values[1:] - values[:-1]) / values[:-1]
log_returns = np.log(values[1:] / values[:-1])

# Plotting the returns
plt.figure(figsize=(10, 6))
plt.plot(arithmetic_returns, label='Arithmetic Returns', marker='o')
plt.plot(log_returns, label='Logarithmic Returns', marker='x')
plt.title('Annual Arithmetic vs. Logarithmic Returns')
plt.xlabel('Year')
plt.ylabel('Returns')
plt.legend()
plt.grid(True)
plt.show()
\end{lstlisting}

\subsubsection{Calculate and Plot Cumulative Returns}

\begin{lstlisting}[language=Python]
# Calculating cumulative returns
cumulative_arithmetic_return = np.cumsum(arithmetic_returns)
cumulative_logarithmic_return = np.exp(np.cumsum(log_returns)) - 1

# Plotting cumulative returns
plt.figure(figsize=(10, 6))
plt.plot(cumulative_arithmetic_return, label='Cumulative Arithmetic Returns', marker='o')
plt.plot(cumulative_logarithmic_return, label='Cumulative Logarithmic Returns', marker='x')
plt.title('Cumulative Arithmetic vs. Logarithmic Returns')
plt.xlabel('Year')
plt.ylabel('Cumulative Returns')
plt.legend()
plt.grid(True)
plt.show()
\end{lstlisting}

\subsubsection{Compare and Discuss}

After plotting the returns, compare the graphs of arithmetic and logarithmic returns, as well as their cumulative returns. Discuss the visual differences and the implications of these differences for investment performance measurement.

\subsubsection{Expected Outcomes}

By now, you should be able to:
\begin{itemize}
    \item Write a Python script to calculate, compare, and plot arithmetic and logarithmic returns.
    \item Visualize the difference in cumulative returns using matplotlib.
    \item Articulate the insights gained from the visual comparison of the two methods.
\end{itemize}

\subsection{Python Exercise: S\&P 500 Futures Data Analysis}

In this exercise, you will apply the concepts of calculating and visualizing returns to real-world financial data. You will download daily data of S\&P 500 front month futures from Yahoo Finance and perform a similar analysis as above.

\subsubsection{Downloading the Data}

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, matplotlib, yfinance
\end{itemize}
yfinance

To get started, you need to download the daily price data for S\&P 500 futures. This can be done using Python's \texttt{pandas} and \texttt{yfinance} libraries. Here is a step-by-step guide to download the data and put it into a pandas dataframe:

\begin{lstlisting}[language=Python]
import yfinance as yf
import pandas as pd

# Downloading S&P 500 futures data
ticker = "ES=F"  # S&P 500 front-month futures ticker symbol
data = yf.download(ticker)

# Creating a pandas dataframe
sp500_data = pd.DataFrame(data)
print(sp500_data.head())  # Displaying the first few rows
\end{lstlisting}

\subsubsection{Your Task}

Using this data, calculate and plot the annual arithmetic and logarithmic returns of the S\&P 500 futures. Then, analyze the cumulative returns over the entire period. You should:

\begin{enumerate}
    \item \textbf{Calculate and Plot Cumulative Returns:} Similar to the previous exercise, calculate the cumulative arithmetic and logarithmic returns for the S\&P 500 futures data.
    \item \textbf{Compare and Discuss:} Analyze the plots and discuss the visual differences. What insights can you gain about the performance of the S\&P 500 futures over this period?
\end{enumerate}

\subsubsection{Expected Learning Outcome}

This exercise will help you to:
\begin{itemize}
    \item Apply the concepts of returns calculation to real-world financial data.
    \item Develop skills in data handling and analysis using Python.
    \item Gain insights into the practical implications of different return measurement methods in financial markets.
\end{itemize}

\textit{Note:} This exercise is exploratory and intended to deepen your understanding of financial data analysis. No solution is provided; you are encouraged to explore and interpret the data independently.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item How are arithmetic returns calculated for an investment?
    \begin{enumerate}
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}} - 1\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item \(\ln(\frac{P_{\text{final}}}{P_{\text{initial}}})\), where \(P_{\text{initial}}\) and \(P_{\text{final}}\) are the initial and final prices of the asset, respectively.
        \item \(\frac{P_{\text{final}} - P_{\text{initial}}}{P_{\text{initial}}}\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item The sum of the natural logarithm of the final price minus the natural logarithm of the initial price.
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}}\), where \(P_{\text{final}}\) and \(P_{\text{initial}}\) are the final and initial values of the investment.
    \end{enumerate}

    \item Which of the following statements are true about the properties of logarithms?
    \begin{enumerate}
        \item \(\ln(a \times b) = \ln(a) + \ln(b)\) for any positive numbers \(a\) and \(b\).
        \item \(\ln\left(\frac{a}{b}\right) = \ln(a) - \ln(b)\) for any positive numbers \(a\) and \(b\).
        \item \(\ln(a^b) = b \times \ln(a)\) for any positive number \(a\) and any number \(b\).
        \item \(\ln(a + b) = \ln(a) + \ln(b)\) for any positive numbers \(a\) and \(b\).
        \item The natural logarithm of a negative number is undefined.
    \end{enumerate}

    \item How are logarithmic returns calculated for an investment?
    \begin{enumerate}
        \item \(\frac{P_{\text{final}} - P_{\text{initial}}}{P_{\text{initial}}}\), where \(P_{\text{initial}}\) and \(P_{\text{final}}\) are the initial and final prices of the asset, respectively.
        \item \(\ln(\frac{P_{\text{final}}}{P_{\text{initial}}})\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item \(\ln(P_{\text{final}}) - \ln(P_{\text{initial}})\), where \(P_{\text{initial}}\) and \(P_{\text{final}}\) are the initial and final prices of the asset, respectively.
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}} - 1\), where \(P_{\text{initial}}\) is the initial investment value and \(P_{\text{final}}\) is the value at the end of the period.
        \item \(\frac{P_{\text{final}}}{P_{\text{initial}}}\), where \(P_{\text{final}}\) and \(P_{\text{initial}}\) are the final and initial values of the investment.
    \end{enumerate}

    \item Based on the advantages and disadvantages of logarithmic and arithmetic returns, which of the following statements are true?
    \begin{enumerate}
        \item Arithmetic returns are more accurate than logarithmic returns for multi-period analysis due to their simplicity in calculation.
        \item Logarithmic returns inherently account for the compounding effects and are more suited for analyzing multiple-period returns.
        \item Arithmetic returns do not consider the compounding effect, which can lead to misleading results in volatile markets over multiple periods.
        \item Logarithmic returns cannot be used for risk assessment and volatility analysis in financial markets.
        \item The total logarithmic return for multiple periods is the product of the logarithmic returns of each period.
    \end{enumerate}

    \item Given a dataframe of daily prices, which Python code snippet is most appropriate to compute the total logarithmic return over a multi-year period?
    \begin{enumerate}
        \item \texttt{total\_log\_return = df['Price'].pct\_change().sum()}
        \item \texttt{total\_log\_return = np.log(df['Price'] / df['Price'].shift(1)).sum()}
        \item \texttt{total\_log\_return = (df['Price'].iloc[-1] / df['Price'].iloc[0]) - 1}
        \item \texttt{total\_log\_return = np.log(df['Price']).diff().sum()}
        \item \texttt{total\_log\_return = (df['Price'].pct\_change() + 1).prod() - 1}
    \end{enumerate}

    \item Consider an investment with the following annual closing values over three years, starting with a \$10 million portfolio:
    \begin{itemize}
        \item Year 1: \$11 million
        \item Year 2: \$8 million
        \item Year 3: \$12 million
    \end{itemize}
    Using logarithmic returns, calculate the total logarithmic return and the final investment value. Which of the following statements are correct?
    \begin{enumerate}
        \item The total logarithmic return is approximately 0.20, and the final investment value is about \$12 million.
        \item The total logarithmic return is approximately 0.18, and the final investment value is about \$11.8 million.
        \item The growth factor calculated from the total logarithmic return is about 1.22.
        \item The final investment value is approximately \$12.2 million.
        \item The cumulative return over the three years is approximately 20\%.
    \end{enumerate}

    \item Given the following annual closing values of an investment portfolio (in millions USD):
    \begin{itemize}
        \item Year 0: \$10.0
        \item Year 1: \$13.0
        \item Year 2: \$7.0
        \item Year 3: \$14.0
        \item Year 4: \$8.0
        \item Year 5: \$16.0
    \end{itemize}

    Which of the following lines of code will correctly calculate the cumulative logarithmic return?
    
    \begin{enumerate}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_arithmetic\_return = np.sum((values[1:] - values[:-1]) / values[:-1])}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_logarithmic\_return = np.exp(np.sum(np.log(values[1:] / values[:-1])))}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_arithmetic\_return = np.prod((values[1:] / values[:-1]) - 1)}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_logarithmic\_return = np.exp(np.sum(np.log(values[1:] / values[:-1]))) - 1}
        \item \texttt{values = np.array([10.0, 13.0, 7.0, 14.0, 8.0, 16.0]) \\
        cumulative\_arithmetic\_return = np.cumsum((values[1:] - values[:-1]) / values[:-1])[-1]}
    \end{enumerate}

\end{enumerate}



\clearpage

\subsection{Harmonizing Performance Measurement}

\subsubsection{The Problem: Comparing Returns Over Different Time Periods}

Consider three different investments, each with returns reported over different time frames. How can you know which one performed best or worst? \\

\textbf{Investment Scenarios}

\begin{itemize}
    \item \textbf{Investment A:} Reported a return of 6\% in one month.
    \item \textbf{Investment B:} Reported a return of 15\% over three months.
    \item \textbf{Investment C:} Reported a return of 25\% over a year.
    \item \textbf{Investment D:} Reported a return of 0.2\% in one day.
    \item \textbf{Investment E:} Reported a return of 1.5\% over one week.
\end{itemize}



\subsubsection{The Solution: Annualizing Logarithmic Returns}

To fairly compare the performance of these investments over different time frames, we utilize the concept of annualizing logarithmic returns. This method allows us to standardize returns to a common time frame (one year), taking into account the effect of compounding.

\subsubsection*{Understanding Logarithmic Returns}

Logarithmic returns, represented as $\ln(1 + r)$ where $r$ is the return, are particularly useful when dealing with compound interest and fluctuating investment values. They allow for additive properties over time, making them ideal for aggregation over different periods.

\subsubsection*{Annualizing the Returns}

The annualization of logarithmic returns involves scaling the log returns to a yearly basis. This is done by multiplying the log return by the number of respective periods in a year.

\subsubsection*{Calculating Annualized Returns for Each Investment}

\textbf{Investment A (Monthly):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.06) \\
    \text{Annualized Return} &= \ln(1 + 0.06) \times 12 \quad \text{(12 months in a year)}
\end{align*}

\textbf{Investment B (Quarterly):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.15) \\
    \text{Annualized Return} &= \ln(1 + 0.15) \times 4 \quad \text{(4 quarters in a year)}
\end{align*}

\textbf{Investment C (Annually):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.25) \quad \text{(Already annual)}
\end{align*}

\textbf{Investment D (Daily):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.002) \\
    \text{Annualized Return} &= \ln(1 + 0.002) \times 252 \quad \text{(252 trading days in a year)}
\end{align*}

\textbf{Investment E (Weekly):}
\begin{align*}
    \text{Logarithmic Return} &= \ln(1 + 0.015) \\
    \text{Annualized Return} &= \ln(1 + 0.015) \times 52 \quad \text{(52 weeks in a year)}
\end{align*}

\subsubsection*{Interpreting the Results}

The annualized logarithmic returns provide a standardized way to compare the investments. A higher annualized return indicates better performance over the year, irrespective of the original investment period. This method accounts for the compound nature of returns, offering a more accurate measure of performance, especially for volatile or inconsistent returns over time.

\subsection{Conclusion}

The annualization of logarithmic returns is a powerful tool in performance measurement, harmonizing the comparison of returns across different investment time frames. It ensures a level playing field, allowing investors and analysts to make informed decisions based on standardized and comparable data.

\subsection{Python Exercise: Downloading S\&P500 Futures Prices and Calculating Annualized Mean Logarithmic Return}

\textbf{Objective:} Download the front month S\&P500 futures prices, compute the logarithmic returns, and then annualize the mean return. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Steps:}

\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure you have the necessary libraries installed. You can install them using pip:
    \begin{verbatim}
    pip install pandas numpy yfinance
    \end{verbatim}

    \begin{lstlisting}[language=Python]
    # Import libraries
    import pandas as pd
    import numpy as np
    import yfinance as yf

    # Use the `yfinance` library to download the front month S&P500 futures price data.
    sp500_futures = yf.download('ES=F')

    # Calculate the daily logarithmic returns of the futures prices.
    sp500_futures['Log_Returns'] = np.log(sp500_futures['Adj Close'] / sp500_futures['Adj Close'].shift(1))

    # Annualize the mean of the logarithmic returns.
    annualized_return = sp500_futures['Log_Returns'].mean() * 252
    print("annualized_return:", annualized_return) 
    \end{lstlisting}
\end{enumerate}

\subsection{Limitations of the Annualized Mean Return as a Metric}

The annualized mean return is a key metric in finance for assessing the average performance of an investment over a standardized one-year period. Despite its prevalence, it comes with several notable limitations:

\begin{itemize}
    \item \textbf{Risk Ignorance:} The metric solely focuses on returns, disregarding the associated risks or volatility. Investments with identical annualized mean returns could have vastly different risk profiles.
    \item \textbf{Past Performance and Future Returns:} It is based on historical data, assuming continuity in performance. However, past returns are not always indicative of future outcomes.
    \item \textbf{Uniform Return Distribution:} The annualized mean return does not account for the distribution of returns, neglecting the possibility of varying skewness and kurtosis.
    \item \textbf{Time Frame Sensitivity:} The return is highly sensitive to the chosen analysis period. Different start and end dates can lead to disparate results due to market fluctuations and economic conditions.
    \item \textbf{Inflation and Real Returns:} Inflation impacts are typically not considered, which can significantly affect the real return on an investment.
\end{itemize}

In conclusion, while the annualized mean return provides a baseline for investment performance evaluation, it should be complemented with other metrics that consider risk, inflation, and specific investment characteristics for a holistic analysis.

\subsection{Python Exercise: Visualizing S\&P 500 Futures Logarithmic Returns Distribution}

\textbf{Objective:} Download the front month S\&P500 futures prices using the `yfinance` library, compute the daily logarithmic returns, and visualize the distribution of these returns in a histogram. Additionally, plot a vertical dashed line to indicate the mean of the daily logarithmic returns. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance, matplotlib
\end{itemize}

\textbf{Steps:}
\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure you have the necessary libraries installed. Install them using pip if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance matplotlib
    \end{verbatim}

    \begin{lstlisting}[language=Python]
    # Import libraries
    import pandas as pd
    import numpy as np
    import yfinance as yf
    import matplotlib.pyplot as plt
    import matplotlib.ticker as ticker

    # Download front month S&P500 futures price data
    sp500_futures = yf.download('ES=F')

    # Calculate daily logarithmic returns of the futures prices
    sp500_futures['Log_Returns'] = np.log(sp500_futures['Adj Close']).diff()

    # Determine the number of bins for the histogram
    max_daily_return = np.round(sp500_futures['Log_Returns'].max(), 2)
    min_daily_return = np.round(sp500_futures['Log_Returns'].min(), 2)
    n_bins = int((max_daily_return - min_daily_return) * 100)

    # Plot a histogram of the logarithmic returns
    plt.hist(sp500_futures['Log_Returns'], bins=n_bins, color="orange", label="Return Distribution")

    # Add a vertical dashed line to indicate the mean of the returns
    plt.axvline(sp500_futures['Log_Returns'].mean(), color='black', linestyle='dashed', linewidth=2, label="Daily Mean Return")

    # Configure the plot
    plt.title('Histogram of S&P 500 Futures Logarithmic Returns')
    plt.xlabel('Logarithmic Returns')
    plt.ylabel('Frequency (log)')
    plt.yscale("log")
    plt.gca().yaxis.set_major_formatter(ticker.StrMethodFormatter('{x:,.0f}'))  # Format y-axis labels as integers
    plt.legend()

    # Display the plot
    plt.show()
    \end{lstlisting}
\end{enumerate}


\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item Given the following investment scenarios with different time frames, calculate the annualized logarithmic returns and identify which investments have the highest and lowest annualized returns.
    \begin{itemize}
        \item Investment F: Reported a return of 7\% in one month.
        \item Investment G: Reported a return of 10\% over two months.
        \item Investment H: Reported a return of 18\% over six months.
        \item Investment I: Reported a return of 0.1\% in one day.
        \item Investment J: Reported a return of 2\% over one week.
    \end{itemize}
    Which of the following statements are correct?

    \begin{enumerate}
        \item Investment F has the highest annualized return.
        \item Investment I has the lowest annualized return.
        \item Investment G has a higher annualized return than Investment H.
        \item Investment J has a higher annualized return than Investment F.
        \item Investment H has the highest annualized return.
    \end{enumerate}

    \item When calculating the annualized mean return using logarithmic returns for a dataset of daily returns, which of the following statements are correct?

    \begin{enumerate}
        \item The annualized mean return can be calculated by summing the logarithmic returns and multiplying by 252.
        \item To calculate the logarithmic return for each day, you divide the price at the end of the day by the price at the beginning of the day.
        \item The annualized mean return provides an average rate of return per month.
        \item Logarithmic returns are preferred as they can be easily summed over time.
        \item The annualized mean return is calculated using simple returns and does not need any scaling factor.
    \end{enumerate}

    \item Which of the following Python code snippets correctly calculates and annualizes the logarithmic returns of an investment based on daily price data?
    \begin{enumerate}
        \item \texttt{annualized\_return = np.log(df['Close'] / df['Close'].shift(1)).mean() * 252}
        \item \texttt{annualized\_return = df['Close'].pct\_change().mean() * 252}
        \item \texttt{annualized\_return = np.sum(np.log(df['Close'] / df['Close'].shift(1))) / len(df) * 252}
        \item \texttt{annualized\_return = np.log(df['Adj Close'] / df['Adj Close'].shift(1)).mean() * 252}
        \item \texttt{annualized\_return = (df['Close'].iloc[-1] / df['Close'].iloc[0] - 1) * 252}
    \end{enumerate}

    \item Which of the following are limitations of using the annualized mean return as a metric for assessing investment performance?
        \begin{enumerate}
            \item It does not consider the risk or volatility associated with the investment.
            \item It assumes that the future performance of an investment will mirror its past performance.
            \item It accounts for the distribution of returns, including skewness and kurtosis.
            \item The metric is sensitive to the specific time frame chosen for analysis.
            \item It adjusts the returns for inflation to provide a real return measure.
        \end{enumerate}

    \item Which of the following lines of code are correct for visualizing the distribution of S\&P 500 Futures Logarithmic Returns?
        \begin{enumerate}
            \item \texttt{plt.hist(sp500\_futures['Log\_Returns'])}
            \item \texttt{plt.axvline(sp500\_futures['Log\_Returns'].mean(), linestyle='dashed', linewidth=2)}
            \item \texttt{plt.ylabel('Frequency (log)'); plt.yscale("log")}
            \item \texttt{sp500\_futures['Log\_Returns'] = np.log(sp500\_futures['Adj Close'] / sp500\_futures['Adj Close'].shift(1))}
            \item \texttt{plt.legend()}
        \end{enumerate}




\end{enumerate}

\clearpage

\section{Measuring Risk}

Now, suppose you are the Head of Portfolio Management at an asset management firm with \$2 billions in assets under management (AUM), and you need to hire a portfolio manager to launch a new fund. From a head hunter, you received the resumes of two candidates, along with a plot of their past performance. \\

How will you choose between the two portfolio manager candidates? Most likely, it will depend on the risk appetite of the investors who are subscribing to the new fund. In the previous sections, we discussed how to measure returns, but how do we measure risk?

\subsection{Volatility}

A common method to measure risk in finance is by computing the standard deviation of returns, also known as volatility. Volatility measures the degree of variation in the returns of an investment over a period. High fluctuations in returns indicate higher risk. Here is how volatility is calculated:

\begin{enumerate}
    \item \textbf{Historical Return Data:}
    Collect the historical return data of the investment over the desired period.

    \item \textbf{Calculate the Mean Return:}
        Compute the average return by summing up the individual returns and then dividing by the number of returns. For a specific example with 5 periods, the mean return is calculated as follows:
        \[ \text{Mean Return} = \frac{\text{Return}_1 + \text{Return}_2 + \text{Return}_3 + \text{Return}_4 + \text{Return}_5}{5} \]
    
        For a more general case with \( n \) periods, where \( n \) could be any number of periods, the formula would be expanded as:
        \[ \text{Mean Return} = \frac{\text{Return}_1 + \text{Return}_2 + \ldots + \text{Return}_n}{n} \]
        Here, the ellipsis (\ldots) represents the continuation of the summation process up to the \( n \)-th term.
    
        Alternatively, using sigma notation for this general case, the mean return is expressed as:
        \[ \text{Mean Return} = \frac{1}{n} \sum_{i=1}^{n} \text{Return}_i \]
    
        Where:
        \begin{itemize}
            \item $\sum$ represents the sum.
            \item $i=1$ to $n$ indicates that the summing is done from the first period to the $n$-th period.
            \item $\text{Return}_i$ is the return for the $i$-th period.
            \item $n$ is the total number of periods.
        \end{itemize}


    \item \textbf{Calculate Deviations from the Mean:}
    For each period's return, calculate its deviation from the mean return. In the context of computing volatility, calculating the deviation of each period's return from the mean return is essential for measuring how much the returns fluctuate around their average, providing a foundational basis for quantifying investment risk.
    \[ \text{Deviation} = \text{Return}_i - \text{Mean Return} \]

    \item \textbf{Square Each Deviation:}
    Square the deviations to eliminate negative values. In the context of computing volatility, we square each deviation to ensure all values are positive (as negative and positive deviations would otherwise cancel each other out), providing a consistent measure of how far returns deviate from the mean, regardless of direction.
    \[ \text{Squared Deviation} = (\text{Return}_i - \text{Mean Return})^2 \]

    \item \textbf{Average of Squared Deviations:}
    Compute the average of these squared deviations, known as variance. In computing volatility, we calculate the average of squared deviations (variance) to determine the typical squared deviation from the mean, providing a consistent measure of spread in returns.
    \[ \text{Variance} = \frac{\sum (\text{Return}_i - \text{Mean Return})^2}{\text{Number of Returns} - 1} \]
    Dividing by \( n-1 \) instead of \( n \) (known as Bessel's correction) provides a more accurate estimate of a population's variance from a sample by compensating for the fact that we're using the sample's mean (not the true population mean), which can otherwise underestimate the actual variability.


    \item \textbf{Standard Deviation (Volatility):}
    Take the square root of the variance to convert the measure back to the same unit as the original returns, thus providing a more interpretable and directly comparable measure of variability.
    \[ \text{Volatility} = \sqrt{\text{Variance}} \]
\end{enumerate}

\textbf{Intuitive Explanation:} 
Imagine hitting a target with several attempts. If most hits are close to the bullseye (the average), the volatility is low, indicating less risk. If the hits are widely scattered, the volatility is high, implying higher risk. In the context of hiring a portfolio manager, you would assess each manager's past portfolio performance by calculating the volatility of their returns. The choice between a manager with lower volatility and one with higher volatility will align with the risk preferences of your investors.

\subsubsection{Annualizing Volatility}

Annualizing volatility is a process of scaling the calculated standard deviation of returns to an annual basis, regardless of the original period of the returns. This standardization allows for a consistent comparison across investments with different time frames. Here's why and how we scale by the square root of the number of periods:

\begin{enumerate}    
    \item \textbf{Scaling Process:}
        To annualize volatility, we multiply the standard deviation (volatility) of the returns by the square root of the number of periods in a year. The formula for annualizing volatility is given by:
        \[ \text{Annualized Volatility} = \text{Volatility} \times \sqrt{\text{Number of Periods in a Year}} \]
    
        Where:
        \begin{itemize}
            \item $\text{Volatility}$ is the standard deviation of the returns calculated over the original time period.
            \item $\text{Number of Periods in a Year}$ depends on the frequency of the data (e.g., 252 for daily, 52 for weekly, 12 for monthly).
        \end{itemize}

        Wait, wait, wait! Where did that square root come from? Why are we multiplying by the square root of the number of periods in a year rather than simply multiplying by the plain number of periods in a year, just like we did when we were annualizing returns in the previous section?

    \item \textbf{Explanation of the Square Root in Annualizing Volatility:}
    The reason we multiply by the square root of the number of periods in a year when annualizing volatility is because we are effectively taking the square root of the annualized variance. Recall that volatility is the standard deviation, which is the square root of variance. When we annualize the variance, we multiply the variance by the number of periods in a year. To convert this annualized variance back to volatility (standard deviation), we must take its square root.

    \begin{itemize}
        \item The annualized variance is given by:
        \[ \text{Annualized Variance} = \text{Variance} \times \text{Number of Periods in a Year} \]
        
        \item Applying the square root to both sides of the equation, we use the property of square roots that $\sqrt{a \times b} = \sqrt{a} \times \sqrt{b}$:
        \[ \sqrt{\text{Annualized Variance}} = \sqrt{\text{Variance} \times \text{Number of Periods in a Year}} \]
        \[ \sqrt{\text{Annualized Variance}} = \sqrt{\text{Variance}}  \times \sqrt{\text{Number of Periods in a Year}} \]
        \[ \text{Annualized Volatility} = \text{Volatility} \times \sqrt{\text{Number of Periods in a Year}} \]

        \item This is why the square root of the number of periods in a year is used in the formula to annualize volatility. It ensures that the scaling of variance to an annual basis is correctly converted back to the standard deviation, providing an accurate measure of annualized volatility.
    \end{itemize}

    This explanation clarifies the mathematical reasoning behind the use of the square root in the process of annualizing volatility, ensuring that the scaling aligns with the statistical properties of variance and standard deviation.


    
    \item \textbf{Examples:}
    \begin{itemize}
        \item \textbf{Daily:} For daily returns, there are approximately 252 trading days in a year. Therefore, the annualized volatility is:
        \[ \text{Annualized Volatility} = \text{Volatility} \times \sqrt{252} \]
        
        \item \textbf{Weekly:} With about 52 weeks in a year, the annualized volatility for weekly returns is:
        \[ \text{Annualized Volatility} = \text{Volatility} \times \sqrt{52} \]
        
        \item \textbf{Monthly:} Given 12 months in a year, for monthly returns, the annualized volatility is:
        \[ \text{Annualized Volatility} = \text{Volatility} \times \sqrt{12} \]
        
        \item \textbf{Annual:} For annual returns, the volatility is already on an annual basis, so no scaling is necessary:
        \[ \text{Annualized Volatility} = \text{Volatility} \]
    \end{itemize}
\end{enumerate}

This scaling allows us to compare the risk (volatility) of different investments on an equal footing, regardless of the time frame of their returns. It's particularly useful in portfolio management for making informed decisions about risk management and asset allocation.

\subsubsection{Example: Computing Annualized Volatility from Monthly Returns}

In this example, we will compute the annualized volatility using a set of monthly returns. The process involves several steps, each detailed below:

\begin{enumerate}
    \item \textbf{Convert Percentage Returns to Decimal}:
    Given the monthly returns in percentages: [5, -3, 7, 6, -4, 2, 3, 7, -5, 4, -6, 8], we convert them to decimal form:
    \[ \text{Decimal Returns} = [0.05, -0.03, 0.07, 0.06, -0.04, 0.02, 0.03, 0.07, -0.05, 0.04, -0.06, 0.08] \]

    \item \textbf{Calculate the Mean Return}:
    The mean return is calculated as the average of these decimal returns:
    \[ \text{Mean Return} = \frac{0.05 - 0.03 + 0.07 + 0.06 - 0.04 + 0.02 + 0.03 + 0.07 - 0.05 + 0.04 - 0.06 + 0.08}{12} \]
    \[ \text{Mean Return} = \frac{0.24}{12} = 0.02 \]

    \item \textbf{Calculate Deviations from the Mean}:
    We calculate the deviation of each return from the mean:
    \[ \text{Deviation} = \text{Return}_i - 0.02 \]
    Resulting in deviations: [0.03, -0.05, 0.05, 0.04, -0.06, 0.00, 0.01, 0.05, -0.07, 0.02, -0.08, 0.06]

    \item \textbf{Square Each Deviation}:
    Each deviation is squared:
    \[ \text{Squared Deviation}_i = (\text{Deviation}_i)^2 \]
    Resulting in squared deviations: [0.0009, 0.0025, 0.0025, 0.0016, 0.0036, 0.0000, 0.0001, 0.0025, 0.0049, 0.0004, 0.0064, 0.0036]

    \item \textbf{Calculate the Variance}:
    The variance is the average of these squared deviations:
    \[ \text{Variance} = \frac{\sum \text{Squared Deviations}}{11} \]
    \[ \text{Variance} = \frac{0.0009 + 0.0025 + 0.0025 + ... + 0.0004 + 0.0064 + 0.0036}{11} \approx 0.00263636 \]

    \item \textbf{Calculate the Standard Deviation (Volatility)}:
    The standard deviation (volatility) is the square root of the variance:
    \[ \text{Volatility} = \sqrt{0.00263636} \approx 0.05135 \]

    \item \textbf{Annualize the Volatility}:
    The annualized volatility is then calculated by multiplying the monthly volatility by the square root of 12:
    \[ \text{Annualized Volatility} = 0.05135 \times \sqrt{12} \approx 0.17787 \]
\end{enumerate}

Therefore, the annualized volatility for these larger monthly returns is approximately 0.17787 or 17.787\%. \\

This detailed step-by-step computation provides an accurate measure of the annualized volatility based on monthly returns, offering a standardized metric for comparing risk across various investments.

\subsection{Python Exercise: Downloading S\&P500 Futures Prices and Calculating Annualized Volatility}

\textbf{Objective:} Download the front month S\&P500 futures prices, compute the logarithmic returns, and then calculate the annualized volatility. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Steps:}

\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure you have the necessary libraries installed. Install them using pip if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance
    \end{verbatim}

    \begin{lstlisting}[language=Python]
    # Import libraries
    import pandas as pd
    import numpy as np
    import yfinance as yf

    # Downloading S&P 500 front month futures price data using yfinance
    sp500_futures = yf.download('ES=F')

    # Calculate the daily logarithmic returns
    sp500_futures['Log_Returns'] = np.log(sp500_futures['Adj Close'] / sp500_futures['Adj Close'].shift(1))

    # Calculate the standard deviation (volatility) of the logarithmic returns
    volatility = sp500_futures['Log_Returns'].std()

    # Annualize the volatility
    # There are approximately 252 trading days in a year
    annualized_volatility = volatility * np.sqrt(252)
    print("Annualized Volatility:", annualized_volatility)
    \end{lstlisting}
\end{enumerate}

\textbf{Note:} This exercise teaches you how to calculate the annualized volatility, a key measure of risk, of S\&P 500 futures. Understanding volatility is crucial in financial markets for assessing the risk associated with investments.

\subsection{Limitations of the Annualized Volatility as a Metric}

The annualized volatility is widely used in finance to quantify the variability or risk associated with the return of an investment over a one-year period. While it is a valuable tool for assessing risk, this metric has several inherent limitations:

\begin{itemize}
    \item \textbf{Assumption of Normal Distribution:} When using annualized volatility as a metric, too many investors and academics often rely on the assumption that returns are normally distributed. However, financial markets frequently exhibit non-normal characteristics, such as skewness and leptokurtosis (heavy tails), leading to an underestimation of extreme market movements.
    \item \textbf{Focus on Total Volatility:} This metric considers both upside and downside volatility equally, which may not align with the perspectives of risk-averse investors who are more concerned about downside risk.
    \item \textbf{Ignores Asymmetry in Returns:} Annualized volatility does not distinguish between periods of high positive returns and periods of high negative returns, treating all deviations from the mean the same way.
    \item \textbf{Time Period Sensitivity:} Similar to annualized mean returns, the annualized volatility is also sensitive to the chosen time frame for analysis. Volatility can vary greatly over different market cycles or economic conditions.
\end{itemize}

In conclusion, while annualized volatility serves as a critical indicator of risk in investment analysis, it is important to recognize its limitations. Investors should ideally use it in conjunction with other risk metrics and analyses that take into account the asymmetry of returns, non-normal distribution characteristics, and the specific nature of the investment instruments.

\subsection{Python Exercise: Analyzing S\&P 500 Futures Logarithmic Returns Distribution with Standard Deviation Lines}

\textbf{Objective:} Use Python to download the front month S\&P500 futures prices, calculate the daily logarithmic returns, and create a histogram to visualize these returns. Enhance the histogram by adding vertical lines to represent the mean and standard deviations (one, two, and three standard deviations away from the mean) on both sides. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance, matplotlib
\end{itemize}

\textbf{Instructions:}
\begin{enumerate}
    \item First, ensure you have the necessary Python libraries (pandas, numpy, yfinance, and matplotlib). Install them using pip if they're not already installed.

    \item Import the required libraries in your Python script.

    \item Utilize the `yfinance` library to download the front month S\&P500 futures price data. Store the downloaded data in a DataFrame.

    \item Calculate the daily logarithmic returns of the S\&P500 futures prices. To do this, use the natural logarithm (`np.log()`) of the 'Adj Close' price divided by its previous day's value. The `diff()` method may be helpful here.

    \item Compute the mean of the logarithmic returns using the `.mean()` method, and store it in a variable named `mean\_return`.

    \item Calculate the standard deviation of the logarithmic returns using the `.std()` method. The code snippet for this and the following steps is provided:
    \begin{lstlisting}[language=Python]
    std_return = sp500_futures['Log_Returns'].std()
    # Adding vertical lines for mean and standard deviations
    plt.axvline(mean_return, color='black', linestyle='dashed', linewidth=2, label="Mean Return")
    for i in range(1, 4):
        plt.axvline(mean_return + i * std_return, color='green', linestyle='dashed', linewidth=1, label=f"+{i} STD")
        plt.axvline(mean_return - i * std_return, color='red', linestyle='dashed', linewidth=1, label=f"-{i} STD")
    \end{lstlisting}

    \item Determine the number of bins for the histogram based on the range of the logarithmic returns. Consider using `np.round()` to round the maximum and minimum log returns and then calculate the number of bins.

    \item Create a histogram of the logarithmic returns using `plt.hist()`. Ensure to label it appropriately.

    \item Add the vertical lines for the mean and standard deviations on the histogram, using the provided code snippet.

    \item Configure your plot with a title, labels for the x-axis and y-axis, and a legend. Set the y-axis scale to logarithmic and format the y-axis labels to display integers.

    \item Finally, display the plot using `plt.show()`.
\end{enumerate}

In this exercise, you will visually analyze the distribution of the S\&P 500 Futures Logarithmic Returns and understand how the returns deviate from the mean, providing insight into the volatility of the asset.


\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}

\item Which of the following statements about the properties of square roots are correct?
    \begin{enumerate}
        \item $\sqrt{a \times b} = \sqrt{a} \times \sqrt{b}$ for any positive numbers \(a\) and \(b\).
        \item $\sqrt{a + b} = \sqrt{a} + \sqrt{b}$ for any positive numbers \(a\) and \(b\).
        \item $\sqrt{a^2} = a$ for any number \(a\).
        \item $\sqrt{a} \times \sqrt{a} = a$ for any positive number \(a\).
        \item $\sqrt{\frac{a}{b}} = \frac{\sqrt{a}}{\sqrt{b}}$ for any positive numbers \(a\) and \(b\).
    \end{enumerate}

    \item What is the general formula for computing annualized volatility from periodic returns?
    \begin{enumerate}
        \item \texttt{annualized\_volatility = volatility * number\_of\_periods}
        \item \texttt{annualized\_volatility = volatility * sqrt(number\_of\_periods)}
        \item \texttt{annualized\_volatility = sqrt(volatility * number\_of\_periods)}
        \item \texttt{annualized\_volatility = volatility / sqrt(number\_of\_periods)}
        \item \texttt{annualized\_volatility = volatility * sqrt(252)}
    \end{enumerate}

    \item Consider a portfolio with a standard deviation of monthly returns (volatility) of 3\%. How is the annualized volatility computed?
    
    \begin{enumerate}
        \item \texttt{annualized\_volatility = 3\% * 12}
        \item \texttt{annualized\_volatility = 3\% * sqrt(12)}
        \item \texttt{annualized\_volatility = 3\% / sqrt(12)}
        \item \texttt{annualized\_volatility = 3\% * sqrt(252)}
        \item \texttt{annualized\_volatility = sqrt(3\% * 12)}
    \end{enumerate}

    \item Consider a short series of monthly returns for an investment: 2\%, -3\%, 6\%, and -4\%. Calculate the annualized volatility of these returns.
    \begin{enumerate}
        \item \(5\%\)
        \item \(10\%\)
        \item \(16\%\)
        \item \(20\%\)
        \item None of the above
    \end{enumerate}

    \item Based on the Python exercise to calculate the annualized volatility of S\&P 500 futures, which of the following lines of code correctly computes the annualized volatility?
    \begin{enumerate}
        \item \texttt{annualized\_volatility = sp500\_futures['Log\_Returns'].std() * np.sqrt(252)}
        \item \texttt{annualized\_volatility = sp500\_futures['Log\_Returns'].std() / np.sqrt(252)}
        \item \texttt{annualized\_volatility = sp500\_futures['Log\_Returns'].std() * 252}
        \item \texttt{annualized\_volatility = sp500\_futures['Log\_Returns'].mean() * np.sqrt(252)}
        \item \texttt{annualized\_volatility = sp500\_futures['Log\_Returns'].var() * np.sqrt(252)}
    \end{enumerate}

    \item Which of the following statements correctly identify the limitations of using annualized volatility as a metric for assessing investment risk?
        \begin{enumerate}
            \item Annualized volatility keeps into account that investment returns are generally not normally distributed.
            \item The metric considers only downside volatility, ignoring any positive fluctuations in investment returns.
            \item Annualized volatility treats periods of high positive returns and high negative returns equally, without distinguishing between them.
            \item The metric is not sensitive to different time frames and provides consistent risk assessments across various market conditions.
            \item Annualized volatility is helpful to measure the likelihood of extreme events.
        \end{enumerate}
    
\end{enumerate}

\clearpage

\subsection{Skewness}

Skewness is a statistical measure used to describe the asymmetry of the distribution of returns in finance. It helps in understanding the tendency of returns to lean towards either higher or lower values than the average. Here is a detailed yet intuitive explanation of how skewness is calculated:

\begin{enumerate}
    \item \textbf{Historical Return Data:}
    Gather the historical return data of the investment over the desired period.

    \item \textbf{Calculate the Mean Return:}
        Compute the average (mean) return. For \( n \) periods, it is calculated as:
        \[ \text{Mean Return} = \frac{1}{n} \sum_{i=1}^{n} \text{Return}_i \]
        Where \( \text{Return}_i \) is the return for the \( i \)-th period.

    \item \textbf{Calculate Deviations from the Mean:}
    Calculate the deviation of each period's return from the mean return. This step is crucial for understanding how far and in which direction each return deviates from the average.
    \[ \text{Deviation} = \text{Return}_i - \text{Mean Return} \]

    \item \textbf{Cube Each Deviation:}
    Cube the deviations to accentuate the impact of extreme values and to retain the sign (positive or negative) of the deviations. This is essential in skewness calculation as it amplifies the effect of asymmetrical tails in the distribution.
    \[ \text{Cubed Deviation} = (\text{Return}_i - \text{Mean Return})^3 \]

    \item \textbf{Average of Cubed Deviations:}
    Compute the average of these cubed deviations. This average represents the central tendency of the cubed deviations and is a key component in measuring skewness.
    \[ \text{Cubed Deviation Average} = \frac{\sum (\text{Return}_i - \text{Mean Return})^3}{n} \]

    \item \textbf{Standard Deviation (Volatility):}
    Compute the standard deviation of the returns, as done in volatility calculation.
    \[ \text{Volatility} = \sqrt{\frac{\sum (\text{Return}_i - \text{Mean Return})^2}{n - 1}} \]

    \item \textbf{Skewness:}
    Finally, skewness is calculated by dividing the average of cubed deviations by the cube of volatility (standard deviation). This normalizes the skewness value, allowing it to be compared across different datasets.
    \[ \text{Skewness} = \frac{\text{Cubed Deviation Average}}{\text{Volatility}^3} \]
\end{enumerate}

\textbf{Intuitive Explanation:} 
Think of skewness as the measure of the symmetry, or lack thereof, in your investment returns. If returns frequently fall far below the average, skewness will be negative, indicating a left-leaning tail. Conversely, if returns often exceed the average by a large margin, skewness will be positive, showing a right-leaning tail. In financial analysis, understanding skewness is like knowing if an archer's missed shots tend to be grouped to one side of the target rather than evenly around it. This information is crucial for an investor to understand the nature of risks in their investment, especially the likelihood of extreme gains or losses.

\subsubsection{Example: Computing Skewness from Monthly Returns}

This example demonstrates a detailed computation of skewness from a set of 12 monthly returns:

\begin{enumerate}
    \item \textbf{Convert Percentage Returns to Decimal}:
    Monthly returns given in percentages: [5, -3, 7, 6, -4, 2, 3, 7, -5, 4, -6, 8]. Conversion to decimal:
    \[ \text{Decimal Returns} = [0.05, -0.03, 0.07, 0.06, -0.04, 0.02, 0.03, 0.07, -0.05, 0.04, -0.06, 0.08] \]

    \item \textbf{Calculate the Mean Return}:
    The mean of these decimal returns is computed:
    \[ \text{Mean Return} = \frac{0.05 - 0.03 + 0.07 + \ldots + 0.04 - 0.06 + 0.08}{12} = 0.02 \]

    \item \textbf{Calculate Deviations from the Mean}:
    Deviation of each return from the mean is calculated:
    \[ \text{Deviation}_1 = 0.05 - 0.02 = 0.03 \] 
    \[ \text{Deviation}_2 = -0.03 - 0.02 = -0.05 \] 
    \[ \ldots \] 
    \[ \text{Deviation}_{12} = 0.08 - 0.02 = 0.06 \]
    Deviations: [0.03, -0.05, 0.05, 0.04, -0.06, 0.00, 0.01, 0.05, -0.07, 0.02, -0.08, 0.06]

    \item \textbf{Cube Each Deviation}:
    Cubing each deviation:
    \[ \text{Cubed Deviation}_1 = (0.03)^3 = 0.000027 \] 
    \[ \text{Cubed Deviation}_2 = (-0.05)^3 = -0.000125 \] 
    \[ \ldots \] 
    \[ \text{Cubed Deviation}_{12} = (0.06)^3 = 0.000216 \]
    Cubed Deviations: [0.000027, -0.000125, 0.000125, 0.000064, -0.000216, 0.000000, 0.000001, 0.000125, -0.000343, 0.000008, -0.000512, 0.000216]

    \item \textbf{Calculate the Average of Cubed Deviations}:
    Computing the average of these cubed deviations:
    \[ \text{Cubed Deviation Average} = \frac{0.000027 - 0.000125 +  \ldots - 0.000512 + 0.000216}{12} = -0.0000525 \]

    \item \textbf{Calculate the Standard Deviation (Volatility)}:
    The standard deviation is the square root of the variance:
    \[ \text{Volatility} = \sqrt{\frac{(0.05 - 0.02)^2 + (-0.03 - 0.02)^2 + \ldots + (0.08 - 0.02)^2}{11}} \approx 0.05135 \]

    \item \textbf{Calculate Skewness}:
    Skewness is calculated by dividing the cubed deviation average by the cube of volatility:
    \[ \text{Skewness} = \frac{-0.0000525}{(0.05135)^3} \approx -0.39 \]
\end{enumerate}

The resulting skewness of -0.38784 indicates a left-leaning distribution of returns, suggesting a higher frequency or extremity of negative returns compared to positive ones. This detailed calculation helps in understanding the asymmetry in the distribution of investment returns.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item Based on the explanation of skewness provided, identify which of the following statements are correct:
    \begin{enumerate}
        \item Skewness measures the degree to which returns are spread out or concentrated on either side of the mean.
        \item A positive skewness indicates a distribution with a long left tail, suggesting a greater likelihood of extremely low returns.
        \item Skewness is calculated by taking the average of the cubed deviations from the mean and dividing it by the cube of the standard deviation.
        \item If the skewness is zero, it implies that the returns distribution is perfectly symmetric.
        \item Positive skewness in financial returns indicates a higher frequency of extreme losses compared to extreme gains.
    \end{enumerate}

    \item Determine the skewness of the following set of 12 monthly returns (in percentages): [2, 5, -10, -7, -7, -3, -1, 9, 8, -6, -4, 2].
    \begin{enumerate}
        \item 0.15
        \item -0.25
        \item 0.23
        \item -0.30
        \item None of the above
    \end{enumerate}

\end{enumerate}

\clearpage

\subsection{Kurtosis}

Kurtosis is a statistical measure used in finance to describe the 'tailedness' of the distribution of returns. It provides insights into the extremity of returns, whether they are unusually large or small compared to the average. Here's how kurtosis is typically calculated:

\begin{enumerate}
    \item \textbf{Historical Return Data:}
    Collect the historical return data for the investment over the desired period.

    \item \textbf{Calculate the Mean Return:}
        Determine the average (mean) return for the period. For \( n \) periods, the mean return is:
        \[ \text{Mean Return} = \frac{1}{n} \sum_{i=1}^{n} \text{Return}_i \]
        Here, \( \text{Return}_i \) is the return for the \( i \)-th period.

    \item \textbf{Calculate Deviations from the Mean:}
    Find the deviation of each period's return from the mean return. This step is important to measure the distance of each return from the average.
    \[ \text{Deviation} = \text{Return}_i - \text{Mean Return} \]

    \item \textbf{Fourth Power of Each Deviation:}
    Raise each deviation to the fourth power. This step emphasizes the impact of extreme values on the distribution.
    \[ \text{Fourth Power Deviation} = (\text{Return}_i - \text{Mean Return})^4 \]

    \item \textbf{Average of Fourth Power Deviations:}
    Compute the average of these fourth power deviations. This average is a key component in measuring kurtosis.
    \[ \text{Fourth Power Deviation Average} = \frac{\sum (\text{Return}_i - \text{Mean Return})^4}{n} \]

    \item \textbf{Standard Deviation (Volatility):}
    Compute the standard deviation (volatility) of the returns.
    \[ \text{Volatility} = \sqrt{\frac{\sum (\text{Return}_i - \text{Mean Return})^2}{n - 1}} \]

    \item \textbf{Kurtosis:}
    Finally, kurtosis is calculated by dividing the average of fourth power deviations by the fourth power of volatility.
    \[ \text{Kurtosis} = \frac{\text{Fourth Power Deviation Average}}{\text{Volatility}^4} \]
    It is common to subtract 3 from this result to center the normal distribution kurtosis at 0 (excess kurtosis).
\end{enumerate}

\textbf{Intuitive Explanation:} 
Consider kurtosis as a measure of the 'weight' of the tails in the distribution of investment returns. High kurtosis (leptokurtic) suggests a distribution with heavy tails and a sharp peak, indicating a higher likelihood of extreme returns (both positive and negative) compared to a normal distribution. Low kurtosis (platykurtic), on the other hand, implies lighter tails and a flatter peak, suggesting fewer extreme returns. Understanding kurtosis helps investors gauge the risk of extreme market movements that could significantly impact their investments.

\subsubsection{Example: Computing Kurtosis from Monthly Returns}

This example illustrates the calculation of kurtosis from a set of 12 monthly returns:

\begin{enumerate}
    \item \textbf{Convert Percentage Returns to Decimal}:
    Given monthly returns in percentages: [5, -3, 7, 6, -4, 2, 3, 7, -5, 4, -6, 8], conversion to decimal is:
    \[ \text{Decimal Returns} = [0.05, -0.03, 0.07, 0.06, -0.04, 0.02, 0.03, 0.07, -0.05, 0.04, -0.06, 0.08] \]

    \item \textbf{Calculate the Mean Return}:
    The mean return is computed as the average of these decimal returns:
    \[ \text{Mean Return} = \frac{0.05 - 0.03 + 0.07 + \ldots + 0.04 - 0.06 + 0.08}{12} = 0.02 \]

    \item \textbf{Calculate Deviations from the Mean}:
    Each return's deviation from the mean is calculated:
    \[ \text{Deviation}_1 = 0.05 - 0.02 = 0.03 \] 
    \[ \text{Deviation}_2 = -0.03 - 0.02 = -0.05 \] 
    \[ \ldots \] 
    \[ \text{Deviation}_{12} = 0.08 - 0.02 = 0.06 \]
    Deviations: [0.03, -0.05, 0.05, 0.04, -0.06, 0.00, 0.01, 0.05, -0.07, 0.02, -0.08, 0.06]

    \item \textbf{Fourth Power Each Deviation}:
    Each deviation is raised to the fourth power:
    \[ \text{Fourth Power Deviation}_1 = (0.03)^4 = 0.00000081 \] 
    \[ \text{Fourth Power Deviation}_2 = (-0.05)^4 = 0.00000625 \] 
    \[ \ldots \] 
    \[ \text{Fourth Power Deviation}_{12} = (0.06)^4 = 0.00001296 \]
    Fourth Power Deviations: [0.00000081, 0.00000625, 0.00000625, 0.00000256, 0.00001296, 0.0, 0.00000001, 0.00000625, 0.00002401, 0.00000016, 0.00004096, 0.00001296]

    \item \textbf{Calculate the Average of Fourth Power Deviations}:
    The average of these fourth power deviations is:
    \[ \text{Fourth Power Deviation Average} = \frac{0.00000081 +  \ldots + 0.00001296}{12} \approx 0.0000094317 \]

    \item \textbf{Calculate the Standard Deviation (Volatility)}:
    The standard deviation is calculated as the square root of the variance:
    \[ \text{Volatility} = \sqrt{\frac{(0.05 - 0.02)^2 + (-0.03 - 0.02)^2 + \ldots + (0.08 - 0.02)^2}{11}} = 0.05135 \]

    \item \textbf{Calculate Kurtosis}:
    Kurtosis is calculated by dividing the fourth power deviation average by the fourth power of volatility:
    \[ \text{Kurtosis} = \frac{0.0000094317}{(0.05135)^4} \approx 1.36 \]
\end{enumerate}

The calculated kurtosis of 1.36 indicates a less peaked distribution with lighter tails compared to a normal distribution. It suggests a lower likelihood of extreme returns (both positive and negative) compared to a normal distribution.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item Based on the explanation of kurtosis, select the correct statements:
        \begin{enumerate}
            \item High kurtosis in a distribution implies a higher likelihood of extreme returns, both positive and negative.
            \item A distribution with low kurtosis (platykurtic) will have a sharper peak and heavier tails than a normal distribution.
            \item Kurtosis is calculated by dividing the average of the fourth power deviations from the mean by the fourth power of the standard deviation (volatility).
            \item If the kurtosis is greater than 3 (leptokurtic), it indicates a flatter peak and lighter tails in the distribution.
            \item Subtracting 3 from the kurtosis result adjusts it to compare with a normal distribution, which has a kurtosis of 3.
        \end{enumerate}

    \item Using the method described for calculating kurtosis, determine the kurtosis of a new set of 12 monthly returns. The returns (in percentages) are as follows: [-3, 3, 4, 0, 1, 3, -3, 7, -8, 8, -7, 4]. Which of the following is the correct kurtosis value for these returns?
        \begin{enumerate}
            \item 0.87
            \item 1.45
            \item 1.75
            \item 2.30
            \item None of the above
        \end{enumerate}

\end{enumerate}

\subsection{Python Exercise: Comparing S\&P 500 Futures Logarithmic Returns with a Normal Distribution}

\textbf{Objective:} Analyze the distribution of S\&P 500 front-month futures logarithmic returns and compare it with a normal distribution curve. The exercise will involve downloading data, calculating returns, and creating a histogram with a normal distribution overlay. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: numpy, yfinance, matplotlib, scipy
\end{itemize}

\textbf{Instructions:}

\begin{enumerate}
    \item \textbf{Import Necessary Libraries:} 
    Begin by importing the required libraries: numpy (as np), yfinance (as yf), matplotlib.pyplot (as plt), and norm from scipy.stats.

    \item \textbf{Download S\&P 500 Futures Data:}
    Use yfinance's `download` function to retrieve the 'Adj Close' prices of S\&P 500 front-month futures ('ES=F'). 

    \item \textbf{Calculate Daily Logarithmic Returns:}
    Compute the daily logarithmic returns of the S\&P 500 futures. Use numpy's `log` function and the `shift` method on the 'Adj Close' prices. Remember to drop any NaN values that result from the calculation.

    \item \textbf{Calculate Mean and Standard Deviation of Returns:}
    Determine the mean and standard deviation of the logarithmic returns. Store these values in variables named `mean` and `std`.
    \begin{lstlisting}[language=Python]
    # Calculate mean and standard deviation of returns
    mean, std = log_returns.mean(), log_returns.std()
    \end{lstlisting}

    \item \textbf{Generate Range of Values for Normal Distribution:}
    Create a range of values (linspace) between the minimum and maximum of the logarithmic returns. Use numpy's `linspace` function and multiply the difference between max and min returns by 10000 to determine the number of bins (`n\_bins`).
    \begin{lstlisting}[language=Python]
    # Generate a range of values for the normal distribution
    n_bins = int(max(log_returns) - min(log_returns) * 10000)
    norm_dist = np.linspace(min(log_returns), max(log_returns), n_bins)
    \end{lstlisting}

    \item \textbf{Calculate Normal Distribution Curve:}
    Compute the normal distribution curve with the same mean and standard deviation as the logarithmic returns. Use the `pdf` function from the `norm` module of scipy.stats.
    \begin{lstlisting}[language=Python]
    # Calculate the normal distribution with the same mean and standard deviation
    normal_curve = norm.pdf(norm_dist, mean, std)
    \end{lstlisting}

    \item \textbf{Plot Histogram and Normal Distribution:}
    Create a histogram of the logarithmic returns and overlay the normal distribution curve on it. Use matplotlib's `plt.hist` for the histogram and `plt.plot` for the normal distribution curve. Ensure the histogram uses the same number of bins as calculated earlier and is colored orange. Label the histogram as 'Actual Distribution' and the curve as 'Normal Distribution'.

    \item \textbf{Add Vertical Lines for Mean and Standard Deviations:}
    Draw vertical dashed lines at the mean and at one, two, and three standard deviations away from the mean on both sides. Color the lines differently for positive (green) and negative (red) standard deviations and label them accordingly.

    \item \textbf{Finalize the Plot:}
    Add a title, labels for the x-axis ('Logarithmic Returns') and y-axis ('Frequency/Density'), and a legend to the plot. Then, display the plot using `plt.show()`.

    \item \textbf{Compute and Print Measures of Return and Risk:}
    Print the annualized return, the annulaized volatility, the skewness and the kurtosis.
    
\end{enumerate}

This exercise will help you visualize how closely the logarithmic returns of S\&P 500 futures follow a normal distribution, providing insights into the nature of return distributions in financial markets.


\clearpage

\subsection{Drawdown}

As a portfolio manager, a client entrusted you with \$10 millions of their net worth and gave you the instruction to allocate 60\% of their capital in stocks and 40\% in bonds. One day, they come to your office and ask: "By how much our capital will go down in the worst case scenario?". What will you respond? \\

There are a couple of radical answers, none of which you are likely to tell your client, unless you really want to lose them as a client: 1) "I have no idea", 2) "In the real worst case scenario, you will lose it all". Instead, you may offer some educated estimate through the analysis of historical drawdowns. \\

Drawdown in finance refers to the peak-to-trough decline during a specific record period of an investment, fund, or trading account. It's a measure of downside risk, highlighting the potential loss an investor might face. Calculating drawdown involves determining the percentage loss from a peak to a subsequent trough. It's important because it helps assess the risk of a portfolio or a specific asset, providing an estimate of the maximum potential loss an investor might experience. This information is crucial for understanding the risk tolerance and managing the investment strategy accordingly. In the context of portfolio management, presenting drawdown to clients provides a realistic view of potential risks and helps in setting expectations.

\subsubsection{Example: Computing Maximum Drawdown}

Let's stick to the example of our client's \$10 million portfolio. Drawdown measures the peak-to-trough decline during a specific period for this investment. Let's see how it's calculated:

\begin{enumerate}
    \item \textbf{Establish the Peak:} The portfolio reaches its highest value. Let's say it peaked at \$12 million.
    \item \textbf{Identify a Trough:} The value then drops to a low point, say \$9 million.
    \item \textbf{Calculate Maximum Drawdown:} Maximum Drawdown is the percentage loss from the peak to the trough.
    \begin{align*}
        \text{Maximum Drawdown} &= \frac{\text{Peak Value} - \text{Trough Value}}{\text{Peak Value}}  \\
                       &= \frac{\$12\text{M} - \$9\text{M}}{\$12\text{M}}  \\
                       &= \frac{\$3\text{M}}{\$12\text{M}}\\
                       &= 25\%
    \end{align*}
\end{enumerate}

This calculation reveals a 25\% drawdown, indicating the maximum percentage decline from the peak during the observed period.

\subsubsection{Computing Drawdown Over Time}

For a more detailed analysis of portfolio drawdown, we would need to compute the drawdown on an ongoing basis. To illustrate the computation of maximum drawdown over time, let's consider a portfolio with monthly returns across a year. We'll calculate the drawdown for each month and identify the maximum drawdown. Here's an example:

\begin{enumerate}
    \item \textbf{Monthly Returns:} Suppose the portfolio has the following monthly returns (in percentages): \\ 

    \begin{table}[H]
    \centering
    \begin{tabular}{|l|c|}
    \hline
    \textbf{Month} & \textbf{Return (\%)} \\ \hline
    January        & 2                    \\ \hline
    February       & -3                   \\ \hline
    March          & 4                    \\ \hline
    April          & -1                   \\ \hline
    May            & 3                    \\ \hline
    June           & -5                   \\ \hline
    July           & 6                    \\ \hline
    August         & -2                   \\ \hline
    September      & 2                    \\ \hline
    October        & -4                   \\ \hline
    November       & 5                    \\ \hline
    December       & -3                   \\ \hline
    \end{tabular}
    \caption{Monthly Portfolio Returns}
    \label{table:monthly-returns}
    \end{table}



    \item \textbf{Cumulative Returns:} Calculate the cumulative return each month. For example, the cumulative return after two months would be the sum of the returns for the first and second months. With the monthly returns mentioned in the example above, our monthly cumulative returns would be the following: \\
    
    \begin{table}[H]
    \centering
    \begin{tabular}{|l|c|c|c|}
    \hline
    \textbf{Month}     & \textbf{Return (\%)} & \textbf{Previous Return (\%)} & \textbf{Cumulative Return (\%)} \\ \hline
    January            & 2                    & 0                             & 2                               \\ \hline
    February           & -3                   & 2                             & -1                              \\ \hline
    March              & 4                    & -3                            & 3                               \\ \hline
    April              & -1                   & 4                             & 2                               \\ \hline
    May                & 3                    & -1                            & 5                               \\ \hline
    June               & -5                   & 3                             & 0                               \\ \hline
    July               & 6                    & -5                            & 6                               \\ \hline
    August             & -2                   & 6                             & 4                               \\ \hline
    September          & 2                    & -2                            & 6                               \\ \hline
    October            & -4                   & 2                             & 2                               \\ \hline
    November           & 5                    & -4                            & 7                               \\ \hline
    December           & -3                   & 5                             & 4                               \\ \hline
    \end{tabular}
    \caption{Monthly Portfolio Returns with Previous and Cumulative Returns}
    \label{table:monthly-returns-previous-cumulative}
    \end{table}
    
    \item \textbf{Tracking Peaks:} Identify the highest cumulative return at each step as the new peak.

    \begin{table}[H]
    \centering
    \begin{tabular}{|l|c|c|}
    \hline
    \textbf{Month}     & \textbf{Cumulative Return (\%)} & \textbf{Cumulative Max (\%)} \\ \hline
    January            & 2                               & 2                            \\ \hline
    February           & -1                              & 2                            \\ \hline
    March              & 3                               & 3                            \\ \hline
    April              & 2                               & 3                            \\ \hline
    May                & 5                               & 5                            \\ \hline
    June               & 0                               & 5                            \\ \hline
    July               & 6                               & 6                            \\ \hline
    August             & 4                               & 6                            \\ \hline
    September          & 6                               & 6                            \\ \hline
    October            & 2                               & 6                            \\ \hline
    November           & 7                               & 7                            \\ \hline
    December           & 4                               & 7                            \\ \hline
    \end{tabular}
    \caption{Monthly Cumulative Returns and Cumulative Maximum}
    \label{table:monthly-cumulative-max}
    \end{table}
    

    \item \textbf{Calculating Drawdown:} For each month, calculate the drawdown from the peak. The drawdown is the difference between the current cumulative return and the highest cumulative return to that point.

    \begin{table}[H]
    \centering
    \begin{tabular}{|l|c|c|c|}
    \hline
    \textbf{Month}     & \textbf{Cumulative Return (\%)} & \textbf{Cumulative Max (\%)} & \textbf{Drawdown (\%)} \\ \hline
    January            & 2                               & 2                            & 0                              \\ \hline
    February           & -1                              & 2                            & 3                              \\ \hline
    March              & 3                               & 3                            & 0                              \\ \hline
    April              & 2                               & 3                            & 1                              \\ \hline
    May                & 5                               & 5                            & 0                              \\ \hline
    June               & 0                               & 5                            & 5                              \\ \hline
    July               & 6                               & 6                            & 0                              \\ \hline
    August             & 4                               & 6                            & 2                              \\ \hline
    September          & 6                               & 6                            & 0                              \\ \hline
    October            & 2                               & 6                            & 4                              \\ \hline
    November           & 7                               & 7                            & 0                              \\ \hline
    December           & 4                               & 7                            & 3                              \\ \hline
    \end{tabular}
    \caption{Monthly Cumulative Returns, Cumulative Maximum, and Ongoing Drawdown}
    \label{table:monthly-cumulative-ongoing-drawdown}
    \end{table}


    \item \textbf{Maximum Drawdown:} The maximum drawdown is the largest of these drawdowns over the 12 months.
\end{enumerate}

This approach allows the portfolio manager to track how the portfolio's value has decreased from its peak over a period, providing an insight into the risk and volatility of the investment.

\subsection{Python Exercise: Calculating and Plotting Ongoing Drawdown of S\&P 500 Futures}

\textbf{Objective:} Download front month S\&P 500 futures prices, compute the logarithmic returns, calculate the cumulative return, and plot the ongoing drawdown with the ongoing drawdown represented as a red area. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance, matplotlib
\end{itemize}

\textbf{Steps:}
\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure the necessary libraries are installed. Use pip to install them if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance matplotlib
    \end{verbatim}

    \item \textbf{Download Data and Calculate Returns:}
    \begin{lstlisting}[language=Python]
    import pandas as pd
    import numpy as np
    import yfinance as yf
    import matplotlib.pyplot as plt

    # Download S&P 500 front month futures data
    sp500_futures = yf.download('ES=F')

    # Calculate logarithmic returns
    sp500_futures['Log_Returns'] = np.log(
        sp500_futures['Adj Close'] / sp500_futures['Adj Close'].shift(1)
        )
    \end{lstlisting}

    \item \textbf{Calculate Cumulative Returns and Ongoing Drawdown:}
    \begin{lstlisting}[language=Python]
    # Calculate cumulative returns
    sp500_futures['Cumulative_Returns'] = np.exp(sp500_futures['Log_Returns'].cumsum()) - 1

    # Calculate ongoing drawdown
    rolling_max = sp500_futures['Cumulative_Returns'].cummax()
    sp500_futures['Drawdown'] = rolling_max - sp500_futures['Cumulative_Returns']

    # Plotting the results
    fig, ax = plt.subplots()
    ax.fill_between(sp500_futures.index, sp500_futures['Drawdown'], 
                    color='red', alpha=0.3)
    ax.plot(sp500_futures['Cumulative_Returns'], label='Cumulative Returns')
    ax.set_title('Cumulative Returns and Ongoing Drawdown')
    ax.set_xlabel('Date')
    ax.set_ylabel('Returns/Drawdown')
    ax.legend()
    plt.show()
    \end{lstlisting}
\end{enumerate}

\textbf{Note:} This exercise teaches you how to calculate and visualize the ongoing drawdown in conjunction with cumulative returns of S\&P 500 futures. The drawdown is represented as a red area in the plot, offering a visual understanding of risk in financial markets.

\subsection{Python Exercise: Calculating and Plotting Ongoing Drawdown of a Mixed Portfolio}

\textbf{Objective:} Construct a portfolio with 60\% weight in S\&P 500 futures (ES=F) and 40\% weight in US 10-year Treasury futures (ZN=F), calculate the logarithmic returns of the portfolio, compute the cumulative return, and plot the ongoing drawdown with the drawdown represented as a red area. Then, print the maximum drawdown, as well the other measures of return and risk we studied so far: annualized return, annualized volatility, skewness and kurtosis. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance, matplotlib
\end{itemize}

\textbf{Steps:}
\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure the necessary libraries are installed. Use pip to install them if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance matplotlib
    \end{verbatim}

    \begin{lstlisting}[language=Python]
    # Import libraries
    import pandas as pd
    import numpy as np
    import yfinance as yf
    import matplotlib.pyplot as plt
    
    # Download S&P 500 and US 10-year Treasury futures data
    sp500_futures = yf.download('ES=F')['Adj Close']
    treasury_futures = yf.download('ZN=F')['Adj Close']
    
    # Align the datasets
    data = pd.DataFrame({
        'SP500': sp500_futures,
        'Treasury': treasury_futures
    }).dropna()
    
    # Calculate daily logarithmic returns
    data['SP500_Returns'] = np.log(data['SP500'] / data['SP500'].shift(1))
    data['Treasury_Returns'] = np.log(data['Treasury'] / data['Treasury'].shift(1))
    
    # Calculate portfolio returns (60% SP500, 40% Treasury)
    data['Portfolio_Returns'] = 0.6 * data['SP500_Returns'] + 0.4 * data['Treasury_Returns']
    
    # Calculate cumulative returns for SP500, Treasury, and Portfolio
    data['Cumulative_SP500_Returns'] = data['SP500_Returns'].cumsum()
    data['Cumulative_Treasury_Returns'] = data['Treasury_Returns'].cumsum()
    data['Cumulative_Returns'] = data['Portfolio_Returns'].cumsum()
    
    # Calculate ongoing drawdown
    rolling_max = data['Cumulative_Returns'].cummax()
    data['Drawdown'] = rolling_max - data['Cumulative_Returns']
    
    # Plotting the results
    fig, ax = plt.subplots()
    ax.fill_between(data.index, -data['Drawdown'], color='red', alpha=0.3)
    ax.plot(data['Cumulative_Returns'], label='Portfolio Cumulative Returns')
    ax.plot(data['Cumulative_SP500_Returns'], label='S&P 500 Cumulative Returns', linestyle='--', linewidth=0.5)
    ax.plot(data['Cumulative_Treasury_Returns'], label='10-Year Treasury Cumulative Returns', linestyle='--', linewidth=0.5)
    ax.set_title('Portfolio Cumulative Returns and Ongoing Drawdown')
    ax.set_xlabel('Date')
    ax.set_ylabel('Returns/Drawdown')
    ax.legend()
    plt.show()
    \end{lstlisting}

    \item \textbf{Compute and Print Measures of Return and Risk:}
    Print the annualized return, the annulaized volatility, the skewness, the kurtosis and the maximum drawdown.
    
\end{enumerate}

\textbf{Note:} This exercise guides you through the process of constructing a mixed asset portfolio, calculating its returns, and visualizing the risk through drawdown analysis. The plot will display the cumulative returns of the portfolio and highlight the drawdown periods in red, offering insights into the risk-return profile of the portfolio.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}

    \item A portfolio manager is analyzing the monthly returns of a portfolio over a year. The monthly returns are as follows: [2\%, -3\%, 4\%, -1\%, 3\%, -5\%, 6\%, -2\%, 2\%, -4\%, 5\%, -3\%]. Calculate the maximum drawdown over this 12-month period.
        \begin{enumerate}
            \item 5\%
            \item 7\%
            \item 8\%
            \item 10\%
            \item None of the above
        \end{enumerate}

    \item A portfolio manager wants to calculate the maximum drawdown of a portfolio using Python. Given a DataFrame 'data' with a column 'Cumulative\_Returns', which line of code correctly computes the maximum drawdown?
        \begin{enumerate}
            \item \texttt{max\_drawdown = data['Cumulative\_Returns'].min() - \\ data['Cumulative\_Returns'].max()}
            \item \texttt{max\_drawdown = (data['Cumulative\_Returns'].cummax() - \\ data['Cumulative\_Returns']).max()}
            \item \texttt{max\_drawdown = (data['Cumulative\_Returns'].max() - \\ data['Cumulative\_Returns']).min()}
            \item \texttt{max\_drawdown = data['Cumulative\_Returns'].max() - \\ data['Cumulative\_Returns'].min()}
            \item \texttt{max\_drawdown = (data['Cumulative\_Returns'] - \\ data['Cumulative\_Returns'].cummin()).max()}
        \end{enumerate}

\end{enumerate}

\clearpage

\section{Measuring Risk-Adjusted Returns}

Once again, suppose you are the Head of Portfolio Management at an asset management firm with \$2 billions in assets under management (AUM), and you need to hire a portfolio manager to launch a new fund. From a head hunter, you received the resumes of several candidates, along with a plot of their past performance. \\

How will you choose between the portfolio manager candidates? Most likely, it will depend on the risk appetite of the investors who are subscribing to the new fund. In the previous sections, we discussed how to measure returns and how to measure risk separately, but wouldn't it be helpful to be able to measure both?

\subsection{Sharpe Ratio}

The Sharpe Ratio is an essential tool for investors to evaluate the performance of an investment relative to its risk. It addresses a fundamental dilemma in investing: the need to balance potential returns with associated risks. \\

\textbf{The Problem: Balancing Return and Risk}

Investors often grapple with choosing between higher-return, higher-risk investments and lower-return, lower-risk alternatives. Opting for investments based solely on high returns disregards the risks involved. Conversely, focusing only on minimizing risk might result in underwhelming returns. The crucial challenge is striking an optimal balance between risk and return. \\

\textbf{The Solution: Sharpe Ratio}

The Sharpe Ratio offers a resolution to this challenge by comparing the performance of an investment to a risk-free asset, while adjusting for the investment's risk. It is calculated using the formula:

\begin{equation}
    \text{Sharpe Ratio} = \frac{R_p - R_f}{\sigma_p}
\end{equation}

where \( R_p \) represents the return of the portfolio, \( R_f \) denotes the risk-free rate (such as the return on Treasury bills), and \( \sigma_p \) is the standard deviation of the portfolio's excess return, a measure of risk. \\

\textbf{Why Sharpe Ratio Works}

\begin{itemize}
    \item \textit{Risk Adjustment:} The Sharpe Ratio incorporates risk by considering the standard deviation of the portfolio’s returns, allowing for a risk-adjusted comparison of different investments.
    \item \textit{Risk-Free Benchmarking:} It references a risk-free asset, showing the additional return earned per unit of risk taken over a risk-free investment.
    \item \textit{Standardized Measurement:} The Sharpe Ratio provides a uniform metric to compare varied investments or portfolios, irrespective of their risk.
    \item \textit{Reward-to-Variability:} A higher Sharpe Ratio suggests a more favorable risk-adjusted return, quantifying the 'reward-to-variability' ratio.
\end{itemize}

\textbf{Practical Application}

Investors utilize the Sharpe Ratio to assess the performance of different funds, portfolios, or individual investments. Generally, a higher Sharpe Ratio is preferred, indicating a more efficient return per unit of risk. It is widely used in finance for portfolio optimization, investment decision-making, and financial planning. \\

In essence, the Sharpe Ratio provides a comprehensive measure that encapsulates both expected returns and associated risks, thereby aiding investors in making well-informed investment decisions.

\subsubsection{Understanding the Risk-Free Rate}

The risk-free rate is a critical component in financial calculations like the Sharpe Ratio. It plays a pivotal role in investment decision-making by providing a benchmark against which the performance of risky assets can be evaluated. \\

\textbf{The Problem: Assessing Return Against a Safe Benchmark}

Investors face the challenge of gauging whether the returns from an investment are sufficient to compensate for the risk undertaken. To make this assessment, one needs a baseline or a benchmark that signifies a 'safe' return, with minimal to no risk involved. \\

\textbf{The Solution: Risk-Free Rate}

The risk-free rate serves as this benchmark. It is theoretically the rate of return of an investment with zero risk of financial loss. In practice, the risk-free rate is the return on the safest possible investment in the financial market. This rate is crucial because:

\begin{itemize}
    \item It represents the minimum return an investor would expect for any risk taken.
    \item It serves as a baseline to compare against returns from risky investments.
    \item It is used to calculate the excess return over a risk-free investment.
\end{itemize}

\textbf{Common Proxies for Risk-Free Rate}

In practice, certain assets are typically used as proxies for the risk-free rate:

\begin{itemize}
    \item \textit{Treasury Bills:} Often, short-term government securities like U.S. Treasury bills are used, as they are backed by the government's promise and are thus considered free of credit risk.
    \item \textit{Government Bonds:} In some cases, long-term government bonds are also used, though they may carry some risk (e.g., interest rate risk).
\end{itemize}

\textbf{Limitations of the Risk-Free Rate Concept}

While the notion of a risk-free rate is widely accepted, it has certain limitations:

\begin{itemize}
    \item \textit{Theoretical Construct:} In reality, no investment is entirely risk-free. Even government securities carry minimal risks, such as inflation risk or interest rate risk.
    \item \textit{Variability Across Countries:} The risk-free rate varies across countries, depending on their economic stability and creditworthiness.
    \item \textit{Impact of Economic Conditions:} The risk-free rate can fluctuate with changing economic conditions, impacting investment decision metrics like the Sharpe Ratio.
\end{itemize}

In summary, the risk-free rate is a fundamental concept in finance, providing a benchmark for evaluating investment returns. However, its theoretical nature and the variability in its practical proxies necessitate careful consideration when using it in financial models and calculations.

\subsection{Python Exercise: Calculating the Sharpe Ratio of S\&P 500 Futures with Annualized Data}

\textbf{Objective:} Download front month S\&P 500 futures prices, compute annualized returns and volatility, download a risk-free rate series, and calculate the Sharpe Ratio. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Steps:}
\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure you have the necessary libraries installed. Use pip to install them if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance
    \end{verbatim}

    \item \textbf{Download S\&P 500 Futures Data and Calculate Returns:}
    \begin{lstlisting}[language=Python]
    import pandas as pd
    import numpy as np
    import yfinance as yf

    # Download S&P 500 front month futures data
    sp500_futures = yf.download('ES=F')['Adj Close']

    # Calculate daily logarithmic returns
    sp500_futures['Log_Returns'] = np.log(
        sp500_futures / sp500_futures.shift(1)
    )
    \end{lstlisting}

    \item \textbf{Annualize Returns and Volatility:}
    \begin{lstlisting}[language=Python]
    # Annualize returns and volatility
    annualized_return = sp500_futures['Log_Returns'].mean() * 252
    annualized_volatility = sp500_futures['Log_Returns'].std() * np.sqrt(252)
    \end{lstlisting}

    \item \textbf{Download Risk-Free Rate Series:}
    \begin{lstlisting}[language=Python]
    # Download the 3-month Treasury bill rate as the risk-free rate
    sp500_start_date = str(sp500_futures.index[0])[:10]
    risk_free_rate_series = yf.download('^IRX', start=sp500_start_date)['Adj Close']
    risk_free_rate = risk_free_rate_series.mean() / 100
    \end{lstlisting}

    \item \textbf{Calculate the Sharpe Ratio:}
    \begin{lstlisting}[language=Python]
    # Calculate the annual Sharpe Ratio
    sharpe_ratio = (annualized_return - risk_free_rate) / annualized_volatility
    print("annualized_return:", annualized_return)
    print("risk_free_rate_annual:", risk_free_rate)
    print("annualized_volatility:", annualized_volatility)
    print("sharpe_ratio:", sharpe_ratio)
    \end{lstlisting}
\end{enumerate}

\textbf{Note:} This exercise guides you through the process of calculating the annual Sharpe Ratio for S\&P 500 futures using real market data for the risk-free rate. The annual Sharpe Ratio helps assess the risk-adjusted performance of an investment relative to its annualized risk.

\subsection{Python Exercise: Calculating the Sharpe Ratio of 10-Year Treasury Futures with Annualized Data}

\textbf{Objective:} In this exercise, students will calculate the annualized returns, volatility, and Sharpe Ratio for the 10-year Treasury futures (ZN=F), following the steps previously taken for S\&P 500 futures. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Task:}
\begin{enumerate}
    \item \textbf{Download 10-Year Treasury Futures Data:} Utilize yfinance to download the 10-year Treasury futures data (ZN=F). Focus on selecting an appropriate time period.
    
    \item \textbf{Calculate Daily Logarithmic Returns:} Compute daily logarithmic returns for the 10-year Treasury futures. This step is similar to what was done for the S\&P 500 futures.
    
    \item \textbf{Annualize Returns and Volatility:} Annualize both the returns and the volatility for the 10-year Treasury futures, akin to the procedure followed for the S\&P 500 futures.
    
    \item \textbf{Use the Same Risk-Free Rate Series:} Apply the 3-month Treasury bill rate as the risk-free rate, ensuring proper alignment of data by date.
    
    \item \textbf{Calculate the Sharpe Ratio:} Use the formula Sharpe Ratio = (Annualized Return - Risk-Free Rate) / Annualized Volatility for the 10-year Treasury futures.
    
    \item \textbf{Interpretation:} Analyze and contrast the calculated Sharpe Ratio for the 10-year Treasury futures with that of the S\&P 500 futures. Discuss the implications for risk-adjusted performance.
\end{enumerate}

\textbf{Considerations:}
\begin{itemize}
    \item Ensure correct alignment of data series by date.
    \item Reflect on the distinct risk and return profiles of equity (S\&P 500) and debt (10-year Treasury) instruments.
    \item Pay attention to consistency in the annualization process.
\end{itemize}

\textbf{Note:} This exercise aims to enhance students' understanding of calculating and interpreting the Sharpe Ratio for different financial instruments, providing insights into the comparative risk-adjusted performance of equity and debt investments.

\subsection{Python Exercise: Calculating the Sharpe Ratio of a Mixed Portfolio with S\&P 500 and 10-Year Treasury Futures}

\textbf{Objective:} This exercise focuses on constructing a mixed portfolio with 60\% weight in S\&P 500 futures (ES=F) and 40\% weight in 10-year Treasury futures (ZN=F), and then calculating the annualized returns, volatility, and Sharpe Ratio for this portfolio. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Task:}
\begin{enumerate}
    \item \textbf{Download Futures Data:} Use yfinance to download both the S\&P 500 futures (ES=F) and the 10-year Treasury futures (ZN=F). Be mindful of selecting a consistent time frame for both datasets.
    
    \item \textbf{Calculate Daily Logarithmic Returns for Each Asset:} Compute daily logarithmic returns separately for the S\&P 500 futures and the 10-year Treasury futures.
    
    \item \textbf{Create a Mixed Portfolio:} Construct a mixed portfolio with 60\% allocated to S\&P 500 futures and 40\% to 10-year Treasury futures. Calculate the portfolio's daily returns based on these weights.
    
    \item \textbf{Annualize Portfolio Returns and Volatility:} Calculate the annualized returns and volatility of the mixed portfolio.
    
    \item \textbf{Utilize the Risk-Free Rate:} Apply the 3-month Treasury bill rate as the risk-free rate. Ensure the data is synchronized with the portfolio's timeline.

    \item \textbf{Compute and Print Measures of Return and Risk:}
    Print the annualized return, the annualized volatility, the skewness, the kurtosis and the maximum drawdown.

    \item \textbf{Compute and Print the Sharpe Ratio:} Using the formula Sharpe Ratio = (Annualized Return - Risk-Free Rate) / Annualized Volatility, compute and print the Sharpe Ratio for the mixed portfolio.

    \item \textbf{Plot the Cumulative Returns and Drawdowns:} Plot the cumulative returns and drawdowns of the mixed portfolio, as well a dashed line for the S\&P 500 futures and a dashed line for the 10-year Treasury futures cumulative profits.

    \begin{lstlisting}[language=Python]
    plt.plot(portfolio_data['Cumulative'], label='Mixed Portfolio')
    plt.plot(sp500_data['Cumulative'], label='S&P 500 Futures', linestyle='dashed')
    plt.plot(treasury_data['Cumulative'], label='10-Year Treasury Futures', linestyle='dashed')
    plt.plot(portfolio_data['Drawdown'], label='Drawdowns')
    
    plt.title('Cumulative Returns and Drawdowns')
    plt.xlabel('Date')
    plt.ylabel('Cumulative Returns')
    plt.legend()
    plt.show()
    \end{lstlisting}
    
    \item \textbf{Analysis and Comparison:} Analyze the Sharpe Ratio of the mixed portfolio and compare it to the individual Sharpe Ratios of the S\&P 500 futures and the 10-year Treasury futures. Discuss the implications for diversification and risk-adjusted performance.
\end{enumerate}

\textbf{Considerations:}
\begin{itemize}
    \item Ensure accurate calculation and alignment of the returns for both components of the mixed portfolio.
    \item Reflect on the impact of diversification on the risk-return profile of the portfolio.
    \item Emphasize the importance of the Sharpe Ratio in assessing the efficiency of a mixed portfolio.
\end{itemize}

\textbf{Note:} This exercise aims to provide a practical understanding of constructing and analyzing a mixed portfolio, focusing on the concepts of diversification, risk-adjusted returns, and the significance of the Sharpe Ratio in portfolio management.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item Why is the Sharpe Ratio considered an essential tool in evaluating investment performance?
    \begin{enumerate}
        \item The Sharpe Ratio only accounts for the return of an investment, ignoring its risk.
        \item It provides a standardized measure to compare different investments, considering both risk and return.
        \item The Sharpe Ratio allows investors to evaluate the additional return earned per unit of risk taken over a risk-free investment.
        \item It helps in determining the highest returning portfolio without considering its volatility.
        \item The ratio incorporates the risk-free rate, enabling a comparison of excess returns over a safe benchmark.
    \end{enumerate}
    
    \item What is the significance of the risk-free rate in financial calculations, and what are its limitations?
    \begin{enumerate}
        \item The risk-free rate represents the guaranteed return that an investor can expect from any investment in the market.
        \item It is used as a benchmark to assess whether the returns from a risky investment are sufficient to compensate for the risk undertaken.
        \item Treasury Bills are often used as a proxy for the risk-free rate due to their government backing and perceived absence of credit risk.
        \item The risk-free rate remains constant and unaffected by economic conditions or interest rate changes.
        \item The concept of the risk-free rate has limitations as no investment is truly risk-free, and it varies across countries based on economic stability.
    \end{enumerate}

    \item When considering the risk-free rate in financial calculations, which of the following can be deemed appropriate proxies, and why?
    \begin{enumerate}
        \item Short-term U.S. Treasury bills, because they are backed by the U.S. government and have minimal credit risk.
        \item Corporate bonds, as they offer higher yields compared to government securities.
        \item Long-term U.S. Treasury bonds, though they may carry some interest rate risk.
        \item High-yield junk bonds, due to their potential for higher returns.
        \item Money market funds, as they are considered stable and have low risk.
    \end{enumerate}

    \item Given annualized returns, annualized volatility, and the risk-free rate from S\&P 500 futures data, which Python line(s) of code correctly compute the Sharpe Ratio?
    \begin{enumerate}
        \item \texttt{sharpe\_ratio = (annualized\_return - risk\_free\_rate) / annualized\_volatility}
        \item \texttt{sharpe\_ratio = annualized\_return / annualized\_volatility}
        \item \texttt{sharpe\_ratio = (annualized\_return + risk\_free\_rate) / annualized\_volatility}
        \item \texttt{sharpe\_ratio = annualized\_volatility / (annualized\_return - risk\_free\_rate)}
        \item \texttt{sharpe\_ratio = (annualized\_return - risk\_free\_rate) / np.sqrt(annualized\_volatility)}
    \end{enumerate}

    \item For a mixed portfolio comprising 60\% S\&P 500 futures and 40\% 10-year Treasury futures, which Python line(s) of code correctly contribute to computing the annual Sharpe Ratio? Assume that `sp500\_returns`, `treasury\_returns`, and `risk\_free\_rate` are already defined as the daily logarithmic returns of S\&P 500 futures, 10-year Treasury futures, and the risk-free rate, respectively.
    \begin{enumerate}
        \item \texttt{mixed\_portfolio\_returns = 0.6 * sp500\_returns + 0.4 * treasury\_returns}
        \item \texttt{annualized\_return = mixed\_portfolio\_returns.mean() * 252}
        \item \texttt{annualized\_volatility = mixed\_portfolio\_returns.std() * np.sqrt(252)}
        \item \texttt{sharpe\_ratio = (annualized\_return - risk\_free\_rate) / annualized\_volatility}
        \item \texttt{sharpe\_ratio = (annualized\_return + risk\_free\_rate) / annualized\_volatility}
    \end{enumerate}
\end{enumerate}

\subsection{Inflation-Adjusted Sharpe Ratio}

Now, another client is considering entrusting you with \$20 millions of their capital. On one condition, though: they want their capital to maintain its purchasing power over time, despite inflation. Hence, your portfolio returns need to beat inflation. This client shows absolutely no interest in the notion of risk-free rate. All they care about is their money to maintain its purchasing power. How will you know if a given portfolio meets your client's requirement? \\

In a scenario where a client is primarily concerned with maintaining the purchasing power of their capital in the face of inflation, the concept of Inflation-Adjusted Sharpe Ratio becomes particularly relevant. This approach addresses a different aspect of investment performance, focusing on the impact of inflation on the value of returns. \\

\subsubsection{The Problem: Maintaining Purchasing Power Against Inflation}

For investors like the client mentioned, the primary concern is not just generating returns but ensuring that these returns are sufficient to outpace inflation. The challenge is to ensure that the investment grows enough to not only provide returns but also preserve or increase the real value of the capital, considering the eroding effect of inflation. \\

\subsubsection{The Solution: Inflation-Adjusted Sharpe Ratio}

The Inflation-Adjusted Sharpe Ratio measures the investment return adjusted for the effects of inflation, providing a clearer picture of risk-adjusted performance in real terms. The Inflation-Adjusted Sharpe Ratio is calculated as follows:

\subsubsection{Formula and Purpose}

\begin{equation}
    \text{Inflation-Adjusted Sharpe Ratio} = \frac{R_p - R_i}{\sigma_p}
\end{equation}

where:
\begin{itemize}
    \item \( R_p \) is the return of the portfolio.
    \item \( R_i \) is the rate of inflation.
    \item \( \sigma_p \) is the standard deviation (volatility) of the portfolio’s returns.
\end{itemize}

This metric substitutes the risk-free rate (\( R_f \)) in the traditional Sharpe Ratio with the rate of inflation (\( R_i \)), making it more relevant for investors whose primary goal is to maintain or increase their purchasing power over time.

\subsubsection{Relevance and Application}

\begin{itemize}
    \item \textit{Focus on Inflation:} This metric is particularly useful in environments with high inflation, where maintaining purchasing power becomes a significant concern for investors.
    \item \textit{Comparative Analysis:} It allows investors to compare how effectively different investments or portfolios are performing in terms of real, inflation-adjusted returns.
    \item \textit{Risk-Adjusted Returns:} By considering volatility (\( \sigma_p \)), it provides a risk-adjusted measure of how much an investment outperforms inflation.
\end{itemize}


\subsection{Python Exercise: Calculating the Inflation-Adjusted Sharpe Ratio of a Mixed Portfolio with S\&P 500 and 10-Year Treasury Futures}

\textbf{Objective:} This exercise focuses on constructing a mixed portfolio with 60\% weight in S\&P 500 futures (ES=F) and 40\% weight in 10-year Treasury futures (ZN=F), and then calculating the annualized returns, volatility, and Inflation-Adjusted Sharpe Ratio for this portfolio. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance, pandas\_datareader
\end{itemize}

\textbf{Task:}
\begin{enumerate}
    \item \textbf{Download Futures Data:} Use yfinance to download both the S\&P 500 futures (ES=F) and the 10-year Treasury futures (ZN=F). Be mindful of selecting a consistent time frame for both datasets.
    
    \item \textbf{Calculate Daily Logarithmic Returns for Each Asset:} Compute daily logarithmic returns separately for the S\&P 500 futures and the 10-year Treasury futures.
    
    \item \textbf{Create a Mixed Portfolio:} Construct a mixed portfolio with 60\% allocated to S\&P 500 futures and 40\% to 10-year Treasury futures. Calculate the portfolio's daily returns based on these weights.
    
    \item \textbf{Annualize Portfolio Returns and Volatility:} Calculate the annualized returns and volatility of the mixed portfolio.
    
    \item \textbf{Utilize the Inflation Rate:} Import inflation rate data from FRED (Federal Reserve Economic Data) using the `pandas\_datareader` library. Specify the series ID for the Consumer Price Index for All Urban Consumers (CPIAUCSL) and choose an appropriate time frame.
    
    \begin{lstlisting}[language=Python]
    # Specify the data source as 'fred' (Federal Reserve Economic Data)
    data_source = 'fred'
    
    # Specify the series ID for the Consumer Price Index for All Urban Consumers (CPIAUCSL)
    series_id = 'CPIAUCSL'
    
    # Define the start and end dates for the data
    start_date = 'YYYY-MM-DD'
    end_date = 'YYYY-MM-DD'
    
    # Fetch the inflation data
    inflation_data = pdr.get_data_fred(series_id, start_date, end_date)
    # Calculate the annualized inflation rate
    inflation_rate = inflation_data['CPIAUCSL'].pct_change(periods=12)
    # Resample monthly inflation data to daily frequency (forward fill)
    inflation_rate = inflation_rate.resample('D').ffill()
    \end{lstlisting}
    
    \item \textbf{Calculate the Inflation-Adjusted Sharpe Ratio:} Using the formula
    \begin{equation}
        \text{Inflation-Adjusted Sharpe Ratio} = \frac{\text{Annualized Return} - R_i}{\text{Annualized Volatility}}
    \end{equation}
    compute the Inflation-Adjusted Sharpe Ratio for the mixed portfolio, where \(R_i\) is the inflation rate.
    
    \item \textbf{Analysis and Comparison:} Analyze the Inflation-Adjusted Sharpe Ratio of the mixed portfolio and compare it to the individual Inflation-Adjusted Sharpe Ratios of the S\&P 500 futures and the 10-year Treasury futures. Discuss the implications for diversification and risk-adjusted performance, considering the goal of maintaining purchasing power.
\end{enumerate}

\textbf{Considerations:}
\begin{itemize}
    \item Ensure accurate calculation and alignment of the returns for both components of the mixed portfolio.
    \item Reflect on the impact of diversification on the risk-return profile of the portfolio, specifically in the context of preserving purchasing power.
    \item Emphasize the importance of the Inflation-Adjusted Sharpe Ratio in assessing the efficiency of a mixed portfolio for a client primarily concerned with maintaining purchasing power.
\end{itemize}

\textbf{Note:} This exercise aims to provide a practical understanding of constructing and analyzing a mixed portfolio, focusing on the concepts of diversification, risk-adjusted returns, and the significance of the Inflation-Adjusted Sharpe Ratio in portfolio management for clients with an inflation-preservation goal.

\subsection{Python Exercise: Calculating the Inflation-Adjusted Sharpe Ratio of Swensen's Portfolio}

\textbf{Objective:} This exercise focuses on constructing a mixed portfolio with a specific asset allocation and then calculating the annualized returns, volatility, and Inflation-Adjusted Sharpe Ratio for this portfolio. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance, pandas\_datareader
\end{itemize}

\textbf{Task:}
\begin{enumerate}
    \item \textbf{Download Asset Data:} Use yfinance to download historical price data for the following ETFs, representing the specified asset allocation from David Swensen's portfolio described in his book "Unconventional Success: A Fundamental Approach to Personal Investment":
    
    \begin{itemize}
        \item US Equity (30\%): SPDR S\&P 500 ETF Trust (SPY) or iShares Core S\&P 500 ETF (IVV)
        \item Foreign Developed Equity (15\%): iShares MSCI EAFE ETF (EFA) or Vanguard FTSE Developed Markets ETF (VEA)
        \item Emerging Market Equity (5\%): iShares MSCI Emerging Markets ETF (EEM) or Vanguard FTSE Emerging Markets ETF (VWO)
        \item US REITs (20\%): Vanguard Real Estate ETF (VNQ) or iShares U.S. Real Estate ETF (IYR)
        \item US Treasury Bonds (15\%): iShares 7-10 Year Treasury Bond ETF (IEF) or iShares 20+ Year Treasury Bond ETF (TLT)
        \item US Treasury Inflation-Protected Securities (TIPS - 15\%): iShares TIPS Bond ETF (TIP) or Schwab U.S. TIPS ETF (SCHP)
    \end{itemize}
    
    Be mindful of selecting a consistent time frame for all ETFs.
    
    \item \textbf{Calculate Daily Logarithmic Returns:} Compute daily logarithmic returns separately for each ETF in the portfolio.
    
    \item \textbf{Create the Mixed Portfolio:} Construct the mixed portfolio with the specified asset allocation percentages. Calculate the portfolio's daily returns based on these weights.
    
    \item \textbf{Annualize Portfolio Returns and Volatility:} Calculate the annualized returns and volatility of the mixed portfolio.
    
    \item \textbf{Utilize the Inflation Rate:} Import inflation data from FRED (Federal Reserve Economic Data) using the `pandas\_datareader` library. Specify the series ID for the Consumer Price Index for All Urban Consumers (CPIAUCSL) and choose an appropriate time frame.
    
    \item \textbf{Calculate the Inflation-Adjusted Sharpe Ratio:} Using the formula
    \begin{equation}
        \text{Inflation-Adjusted Sharpe Ratio} = \frac{\text{Annualized Return} - R_i}{\text{Annualized Volatility}}
    \end{equation}
    compute the Inflation-Adjusted Sharpe Ratio for the mixed portfolio, where \(R_i\) is the inflation rate.
    
    \item \textbf{Analysis and Comparison:} Analyze the Inflation-Adjusted Sharpe Ratio of the mixed portfolio and compare it to the individual Inflation-Adjusted Sharpe Ratios of the ETFs representing each asset class. Discuss the implications for diversification and risk-adjusted performance, considering the goal of maintaining purchasing power.
\end{enumerate}

This exercise allows you to implement a specific asset allocation strategy and assess its performance in the context of inflation-adjusted returns. Remember to conduct your research and due diligence when selecting specific ETFs, and consult with a financial advisor or investment professional for personalized guidance.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item When is the Inflation-Adjusted Sharpe Ratio particularly relevant for investors?
    \begin{enumerate}
        \item Only in low-inflation environments
        \item Only in high-inflation environments
        \item In environments with high inflation
        \item In environments with low volatility
        \item In environments with declining interest rates
    \end{enumerate}

    \item Which library should be used to download inflation rate data from FRED (Federal Reserve Economic Data) in Python?
    \begin{enumerate}
        \item \texttt{pandas}
        \item \texttt{numpy}
        \item \texttt{yfinance}
        \item \texttt{pandas\_datareader}
        \item \texttt{matplotlib}
    \end{enumerate}

    \item Which of the following lines of code correctly calculates the Inflation-Adjusted Sharpe Ratio for a mixed portfolio?
    \begin{enumerate}
        \item \texttt{inflation\_adjusted\_sharpe\_ratio = (annualized\_return - inflation\_rate.mean()) / annualized\_volatility}
        \item \texttt{inflation\_adjusted\_sharpe\_ratio = (portfolio\_return.mean() * 252 - inflation\_rate) / portfolio\_volatility}
        \item \texttt{inflation\_adjusted\_sharpe\_ratio = (annualized\_return - R\_i) / annualized\_volatility}
        \item \texttt{inflation\_adjusted\_sharpe\_ratio = (annualized\_return - inflation\_rate) / np.sqrt(252)}
        \item \texttt{inflation\_adjusted\_sharpe\_ratio = (portfolio\_return.mean() * 252 - inflation\_rate.mean()) / (portfolio\_volatility * np.sqrt(252))}
    \end{enumerate}

\end{enumerate}

\subsection{Information Ratio}

Now, let's envision another scenario: you are a portfolio manager at an asset management firm and a high-net-worth prospective client comes to you for information. The client is a successful entrepreneur who amassed a \$13-million net worth through their business. They were good at making money but they do not understand much about investing in capital markets. They come from an industrial engineering background, did not study much finance in engineering school and spent most of their time building their business. As a result, they accumulated a sizeable amount of money but do not really know what to do with it. They just read and heard stories about Warren Buffett and his legendary Berkshire Hathaway and how it "outperformed the market". Your client comes from an engineering background, so they have an analytical mind, and wants to know what it means exactly that Berkshire Hathaway "outperformed the market" and - most importantly - how Berkshire Hathaway's overperformance is measured with numbers. How would you answer your prospective client's question? \\

This is where the Information Ratio (IR) might be of help. The Information Ratio (IR) is another metric in the field of investment management, particularly for assessing the performance of active fund managers relative to a specific benchmark. In the case of the client mentioned above, the benchmark may be the S\&P 500 Index. \\

While similar to the Sharpe Ratio in evaluating risk-adjusted returns, the Information Ratio has distinct attributes that make it a valuable tool. \\

\subsubsection{Formula and Comparison of Information Ratio to Sharpe Ratio}

The Information Ratio and the Sharpe Ratio are both critical metrics in finance, but they serve different purposes and are based on different formulas. Let's delve into their formulas and understand how they differ.

\paragraph{Information Ratio Formula:}
The Information Ratio (IR) is calculated using the formula:
\begin{equation}
    \text{Information Ratio} = \frac{R_p - R_b}{\sigma_{\text{excess}}}
\end{equation}
where:
\begin{itemize}
    \item \( R_p \) is the return of the portfolio.
    \item \( R_b \) is the return of the benchmark.
    \item \( \sigma_{\text{excess}} \) is the standard deviation of the excess return of the portfolio over the benchmark, often referred to as the 'tracking error'.
\end{itemize}

\paragraph{Sharpe Ratio Formula:}
In contrast, the Sharpe Ratio is calculated as:
\begin{equation}
    \text{Sharpe Ratio} = \frac{R_p - R_f}{\sigma_p}
\end{equation}
where:
\begin{itemize}
    \item \( R_f \) represents the risk-free rate.
    \item \( \sigma_p \) is the standard deviation of the portfolio’s return.
\end{itemize}

\paragraph{Computing the Tracking Error}

The standard deviation of the excess return of a portfolio over its benchmark, also known as the 'tracking error', is a key measure in portfolio management. It quantifies the consistency and magnitude of the portfolio's performance relative to the benchmark. Here is how it is computed:

\begin{enumerate}
    \item \textbf{Calculate Excess Returns:}
    \begin{itemize}
        \item Determine the excess returns for each period by subtracting the benchmark return from the portfolio return.
        \item Formula: \( \text{Excess Return}_t = \text{Portfolio Return}_t - \text{Benchmark Return}_t \).
    \end{itemize}

    \item \textbf{Compute Standard Deviation of Excess Returns:}
    \begin{itemize}
        \item The standard deviation of these excess returns is calculated to assess the volatility of the portfolio's performance compared to the benchmark.
        \item Formula: 
        \[
        \sigma_{\text{excess}} = \sqrt{\frac{1}{N - 1} \sum_{t=1}^{N} (\text{Excess Return}_t - \overline{\text{Excess Return}})^2}
        \]
        where \( N \) is the number of periods, \( \text{Excess Return}_t \) is the excess return at time \( t \), and \( \overline{\text{Excess Return}} \) is the mean excess return.
    \end{itemize}

    \item \textbf{Interpretation of Tracking Error:}
    \begin{itemize}
        \item A higher tracking error indicates a greater divergence from the benchmark, signifying higher active risk.
        \item A lower tracking error implies that the portfolio closely follows its benchmark.
    \end{itemize}
\end{enumerate}

Understanding the tracking error is crucial for assessing the risk taken by a portfolio manager in attempting to outperform the benchmark. It reflects the consistency and scale of over- or underperformance relative to the benchmark.

\paragraph{Key Differences:}
\begin{enumerate}
    \item \textbf{Benchmark Reference:}
    The most significant difference is in the benchmark used. The Information Ratio uses a specific benchmark or index (\( R_b \)) as a reference, while the Sharpe Ratio uses a risk-free rate (\( R_f \)).

    \item \textbf{Focus on Excess Return:}
    The IR focuses specifically on the excess return over a benchmark, making it ideal for evaluating active management. In contrast, the Sharpe Ratio looks at the excess return over a risk-free asset, assessing overall risk-adjusted return.

    \item \textbf{Risk Assessment:}
    The IR uses the standard deviation of excess returns (tracking error), which measures the consistency of outperforming or underperforming the benchmark. The Sharpe Ratio uses the standard deviation of the portfolio’s total returns, measuring overall investment risk.
\end{enumerate}

These differences make the Information Ratio particularly useful for comparing the performance of active managers relative to their benchmarks, while the Sharpe Ratio is better suited for evaluating the risk-adjusted returns of an investment relative to a risk-free asset.

\subsubsection{The Purpose of Computing the Information Ratio}

\begin{enumerate}
    \item \textbf{Benchmark Comparison:}
    The IR measures the excess return of an investment relative to a chosen benchmark, adjusted for the variability of these excess returns. This is in contrast to the Sharpe Ratio, which compares returns to a risk-free rate, making the IR more suitable for strategies aiming to outperform a market index.

    \item \textbf{Active Management Evaluation:}
    The IR is particularly useful for evaluating the skill of active fund managers. It quantifies the additional return generated over the benchmark, per unit of additional risk, highlighting the manager's ability to make effective investment decisions.
\end{enumerate}

\subsubsection{Unique Insights Offered by the Information Ratio}

\begin{enumerate}
    \item \textbf{Relative Performance:}
    The IR captures the performance of a portfolio or fund manager relative to a benchmark, emphasizing the results of active management strategies.

    \item \textbf{Consistency of Outperformance:}
    A high Information Ratio indicates consistent outperformance of the benchmark, highlighting the manager's skill in generating returns.

    \item \textbf{Focus on Active Risk:}
    The IR considers the 'active risk' or 'tracking error', which is the standard deviation of the excess returns over the benchmark. This provides insights into the manager’s ability to generate returns above the benchmark, adjusted for the volatility of those excess returns.
\end{enumerate}

In conclusion, the Information Ratio offers a nuanced perspective on a manager's performance against a benchmark. It complements the Sharpe Ratio by focusing on the effectiveness of active portfolio management, providing a more detailed picture of a manager's ability to generate superior risk-adjusted returns. \\

\subsection{Python Exercise: Calculating the Information Ratio of Berkshire Hathaway with S\&P 500 as Benchmark}

\textbf{Objective:} Download Berkshire Hathaway stock prices and S\&P 500 front month futures prices, compute annualized excess returns over the benchmark, and calculate the Information Ratio. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Steps:}
\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure you have the necessary libraries installed. Use pip to install them if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance
    \end{verbatim}

    \item \textbf{Download Data:}
    \begin{lstlisting}[language=Python]
    import pandas as pd
    import numpy as np
    import yfinance as yf

    # Download Berkshire Hathaway stock data
    berkshire = yf.download('BRK-A')['Adj Close']
    # Download S&P 500 front month futures data
    sp500_futures = yf.download('ES=F')['Adj Close']
    \end{lstlisting}

    \item \textbf{Calculate Daily Logarithmic Returns:}
    \begin{lstlisting}[language=Python]
    # Compute latest starting date
    berkshire_start_date = berkshire.index[0]
    sp500_start_date = sp500_futures.index[0]
    latest_start_date = max(berkshire_start_date, sp500_start_date)
    
    # Use only data starting from the latest starting data, 
    # so that we have the same data points for both series
    berkshire = berkshire.loc[latest_start_date:]
    sp500_futures = sp500_futures.loc[latest_start_date:]
    
    # Calculate daily logarithmic returns
    berkshire['Log_Returns'] = np.log(berkshire / berkshire.shift(1))
    sp500_futures['Log_Returns'] = np.log(sp500_futures / sp500_futures.shift(1))
    \end{lstlisting}

    \item \textbf{Compute Excess Returns over the Benchmark:}
    \begin{lstlisting}[language=Python]
    # Compute excess returns
    excess_returns = berkshire['Log_Returns'] - sp500_futures['Log_Returns']
    \end{lstlisting}

    \item \textbf{Annualize Excess Returns and Calculate Information Ratio:}
    \begin{lstlisting}[language=Python]
    # Annualize excess returns
    annualized_excess_return = excess_returns.mean() * 252
    tracking_error = excess_returns.std() * np.sqrt(252)

    # Calculate the Information Ratio
    information_ratio = annualized_excess_return / tracking_error
    print("Information Ratio:", information_ratio)
    \end{lstlisting}
\end{enumerate}

\textbf{Note:} This exercise is focused on calculating the Information Ratio of Berkshire Hathaway's returns compared to the S\&P 500 futures as a benchmark. The Information Ratio is a crucial metric for evaluating the performance of an investment relative to a benchmark, offering insights into the risk-adjusted excess returns achieved by the portfolio.

\subsection{Python Exercise: Calculating the Information Ratio of an Equally-Weighted FAANG Portfolio with NASDAQ as Benchmark}

\textbf{Objective:} Create an equally-weighted portfolio of FAANG companies (Facebook, Apple, Amazon, Netflix, Google), download their stock prices and NASDAQ index prices, and guide students to compute the annualized excess returns over the NASDAQ benchmark, and calculate the Information Ratio. \\

\textbf{Requirements:}
\begin{itemize}
    \item Python
    \item Libraries: pandas, numpy, yfinance
\end{itemize}

\textbf{Task Overview:}
\begin{enumerate}
    \item \textbf{Install Required Libraries:} Ensure the necessary libraries are installed. Use pip to install them if needed:
    \begin{verbatim}
    pip install pandas numpy yfinance
    \end{verbatim}

    \item \textbf{Download Data:}
    \begin{lstlisting}[language=Python]
    import pandas as pd
    import numpy as np
    import yfinance as yf

    # Download stock data for FAANG companies
    faang_tickers = ['META', 'AAPL', 'AMZN', 'NFLX', 'GOOGL']
    faang_data = yf.download(faang_tickers, start='YYYY-MM-DD')['Adj Close']

    # Download NASDAQ index data
    nasdaq_data = yf.download('NQ=F', start='YYYY-MM-DD')['Adj Close']
    \end{lstlisting}

    \item \textbf{Instructions for the Rest of the Exercise:}
    \begin{enumerate}
        \item Compute daily logarithmic returns for each FAANG company and the NASDAQ index.
        \item Create an equally-weighted portfolio of FAANG companies by averaging their daily returns.
        \item Calculate the excess returns of the FAANG portfolio over the NASDAQ benchmark.
        \item Annualize the excess returns and compute the standard deviation of these excess returns (tracking error).
        \item Calculate the Information Ratio using the formula \(\text{Information Ratio} = \frac{\text{Annualized Excess Return}}{\text{Tracking Error}}\).
        \item Interpret the results, focusing on what the Information Ratio indicates about the FAANG portfolio's performance relative to the NASDAQ.
    \end{enumerate}
    
    \textbf{Guidance:}
    \begin{itemize}
        \item Ensure accurate alignment of the time frames and data points for both the FAANG portfolio and the NASDAQ index.
        \item Pay attention to the calculation of the tracking error, as it is crucial for the accurate computation of the Information Ratio.
        \item Reflect on the implications of the Information Ratio in the context of the FAANG portfolio's risk-adjusted performance compared to the NASDAQ benchmark.
    \end{itemize}

    \textbf{Note:} This exercise aims to develop an understanding of the Information Ratio as a measure of risk-adjusted performance relative to a benchmark. It also emphasizes the significance of portfolio construction and benchmark selection in performance evaluation.
\end{enumerate}

\textbf{Objective for Students:} Students should complete the exercise by following the instructions provided after downloading the data. They will need to apply their understanding of Python programming and financial analysis concepts to calculate and interpret the Information Ratio of the FAANG portfolio compared to the NASDAQ.

\subsection{Limitations of Sharpe Ratio and Information Ratio}

While the Sharpe Ratio and Information Ratio can be helpful tools in investment analysis and portfolio management, they do have certain limitations:

\subsubsection{Limitations of the Sharpe Ratio}
\begin{enumerate}
    \item Sensitivity to Risk-Free Rate: The Sharpe Ratio is sensitive to changes in the risk-free rate. During periods of low interest rates, the Sharpe Ratio can be artificially inflated, suggesting better risk-adjusted performance than is actually the case.
    \item Single Period Measure: It typically uses a single-period model of risk and return, which may not accurately capture the investment's risk over multiple periods or in different market conditions.
    \item No Distinction Between Positive and Negative Volatility: The Sharpe Ratio treats all volatility as bad, not differentiating between upside and downside volatility. This could be misleading for investments that have high positive volatility.
\end{enumerate}

\subsubsection{Limitations of the Information Ratio}
\begin{enumerate}
    \item Benchmark Dependency: The effectiveness of the Information Ratio is highly dependent on the choice of benchmark. An inappropriate benchmark can lead to misleading IR values.
    \item Tracking Error as a Risk Measure: The IR uses tracking error as a measure of risk, which only reflects the deviation from the benchmark, not the total risk of the portfolio.
    \item Not Suitable for Passive Management: The IR is less relevant for passively managed funds or portfolios that aim to replicate a benchmark, as these strategies inherently have low tracking errors.
    \item Time Period Sensitivity: Like the Sharpe Ratio, the Information Ratio can be sensitive to the time period chosen for analysis. Different periods can yield significantly different IR values.
\end{enumerate}

\subsubsection{General Limitations}
\begin{enumerate}
    \item Risk Measure Limitations: Both ratios use standard deviation as a measure of risk, which may not fully capture the true risk of an investment, especially for asymmetrical return distributions..
    \item Not Accounting for Tail Risk: Neither ratio adequately captures tail risk (the risk of extreme loss), which can be critical in assessing the safety of an investment.
    \item Historical Data Dependency: Both ratios are based on historical data, which may not be a reliable indicator of future performance, especially in rapidly changing market conditions.
    \item No Consideration for Investment Objectives: These metrics do not take into account the specific investment objectives or constraints of an investor.
\end{enumerate}

In summary, while the Sharpe Ratio and Information Ratio provide valuable insights into risk-adjusted returns, they should be used in conjunction with other metrics and qualitative analysis to get a comprehensive understanding of an investment's performance and risk profile.

\subsection{Quiz}
For each question, select one or more correct answers.

\begin{enumerate}
    \item Consider the scenario where an investor seeks to evaluate the performance of active fund managers. Given the purpose and characteristics of the Information Ratio (IR) and the Sharpe Ratio, which of the following statements are correct regarding the use of the Information Ratio for this purpose?
    \begin{enumerate}
        \item The Information Ratio should be preferred over the Sharpe Ratio because it specifically measures the manager's ability to generate returns above a specified benchmark.
        \item The Sharpe Ratio is more suitable than the Information Ratio for evaluating active fund managers since it focuses on the total risk-adjusted returns.
        \item The Information Ratio is appropriate for assessing active management as it takes into account the tracking error, reflecting the manager’s skill in outperforming the benchmark.
        \item The Information Ratio should not be used for active fund managers because it only considers the risk-free rate.
        \item The Information Ratio is preferred in this context because it provides insights into the consistency of the manager's outperformance relative to the benchmark.
    \end{enumerate}
    
    \item In the context of evaluating a portfolio manager's performance, consider the Information Ratio (IR) and Sharpe Ratio. Which of the following statements correctly reflect the computation of the Information Ratio and its differences from the Sharpe Ratio?
    \begin{enumerate}
        \item The Information Ratio is calculated as \(\frac{R_p - R_b}{\sigma_{\text{excess}}}\), where \(R_p\) is the portfolio return, \(R_b\) is the benchmark return, and \(\sigma_{\text{excess}}\) is the standard deviation of the portfolio's excess returns over the benchmark.
        \item The Sharpe Ratio, unlike the Information Ratio, uses the risk-free rate instead of a benchmark return in its formula.
        \item The Information Ratio uses the standard deviation of the portfolio's total returns, similar to the Sharpe Ratio.
        \item The Information Ratio focuses on the excess return over a benchmark, while the Sharpe Ratio assesses the excess return over a risk-free asset.
        \item The standard deviation in the Information Ratio formula (\(\sigma_{\text{excess}}\)) is the standard deviation of the portfolio's return, not the excess return over the benchmark.
    \end{enumerate}

    \item In the context of calculating the Information Ratio for Berkshire Hathaway against the S\&P 500 as a benchmark, consider the following lines of Python code. Which of these correctly contribute to computing the Information Ratio?
    \begin{enumerate}
        \item \texttt{excess\_returns = berkshire['Log\_Returns'] - sp500\_futures['Log\_Returns']}
        \item \texttt{annualized\_excess\_return = excess\_returns.mean() * 252}
        \item \texttt{information\_ratio = annualized\_excess\_return / excess\_returns.std()}
        \item \texttt{tracking\_error = np.sqrt(np.var(excess\_returns) * 252)}
        \item \texttt{information\_ratio = (berkshire['Log\_Returns'].mean() - \\ sp500\_futures['Log\_Returns'].mean()) / tracking\_error}
    \end{enumerate}

    \item Which of the following lines of Python code are necessary for computing the Information Ratio of an equally-weighted FAANG portfolio against the NASDAQ benchmark? Select all that apply.
    
    \begin{enumerate}
        \item \texttt{faang\_portfolio\_returns = faang\_data.mean(axis=1)}
        \item \texttt{excess\_returns = faang\_portfolio\_returns - nasdaq\_data}
        \item \texttt{annualized\_excess\_return = excess\_returns.mean() * 252}
        \item \texttt{tracking\_error = excess\_returns.std() * np.sqrt(252)}
        \item \texttt{information\_ratio = annualized\_excess\_return / tracking\_error}
    \end{enumerate}

    \item What are the limitations of the Sharpe Ratio?
    \begin{enumerate}
        \item It assumes that returns are normally distributed.
        \item It is sensitive to changes in the risk-free rate.
        \item It treats all volatility as bad, not differentiating between upside and downside volatility.
        \item It is sensitive to the time period chosen for analysis.
        \item It is highly dependent on the choice of benchmark.
    \end{enumerate}

    \item What are the limitations of the Information Ratio?
    \begin{enumerate}
        \item It assumes that returns are normally distributed.
        \item It is highly dependent on the choice of benchmark.
        \item It uses tracking error as a measure of risk, which only reflects deviation from the benchmark.
        \item It is not suitable for passively managed funds or portfolios that aim to replicate a benchmark.
        \item It is sensitive to changes in the risk-free rate.
    \end{enumerate}

\end{enumerate}

\clearpage

\subsection{Sortino Ratio}

The Sortino Ratio, similar to the Sharpe Ratio, is a tool for evaluating the risk-adjusted return of an investment or portfolio. However, it addresses a specific limitation of the Sharpe Ratio. \\

\textbf{Main Limitation of Sharpe Ratio Addressed by Sortino Ratio:}

The primary limitation of the Sharpe Ratio that the Sortino Ratio seeks to address is its treatment of all volatility as equally risky. The Sharpe Ratio does not differentiate between upside and downside volatility, treating both as indicative of risk. However, investors are typically more concerned with downside risk -- the risk of losses -- rather than volatility associated with above-average returns. \\

\textbf{The Solution: Sortino Ratio}

The Sortino Ratio modifies the concept of the Sharpe Ratio by focusing only on the downside risk. It is calculated using the formula:

\begin{equation}
    \text{Sortino Ratio} = \frac{R_p - R_f}{\sigma_d}
\end{equation}

where \( R_p \) represents the return of the portfolio, \( R_f \) denotes the risk-free rate, and \( \sigma_d \) is the standard deviation of the portfolio's negative returns, known as downside deviation. \\

\textbf{Why Sortino Ratio Works}

\begin{itemize}
    \item \textit{Focus on Downside Risk:} The Sortino Ratio provides a more relevant measure of risk for investors who are primarily concerned about losses rather than fluctuations in positive returns.
    \item \textit{Improved Risk Assessment:} By isolating downside volatility, the Sortino Ratio offers a more precise assessment of the risk an investor is taking in pursuit of excess returns.
    \item \textit{Better Suitability for Asymmetrical Distributions:} For portfolios that exhibit skewed or non-normal return distributions, the Sortino Ratio can provide a more accurate picture of risk-adjusted performance.
\end{itemize}

\textbf{Practical Application}

The Sortino Ratio is particularly useful for evaluating investments or strategies that aim to minimize downside risk, such as retirement portfolios or funds with loss aversion objectives. It allows investors to understand not just the return per unit of risk, but the return per unit of downside risk, aligning more closely with many investors' risk concerns. \\

In conclusion, the Sortino Ratio enhances the concept of risk-adjusted return by focusing specifically on the risk that matters most to investors: the risk of losing money. It serves as a complementary metric to the Sharpe Ratio, particularly valuable when assessing investments where downside risk is a primary concern.

\clearpage

\bibliography{references}

\end{document}
